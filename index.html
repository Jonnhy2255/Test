<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ChatXchange</title>
    
    <!-- PWA Meta Tags pour iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ChatXchange">
    <meta name="theme-color" content="#5D5CDE">
    
    <!-- IcÃ´nes pour iOS -->
    <link rel="apple-touch-icon" href="data:image/png;base64,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">
    <link rel="apple-touch-icon" sizes="152x152" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJgAAACYCAYAAAAYwiAhAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAqnSURBVHgB7Z1dbBRVFMfPndlCAbVQCgXalrIUECT4LYiJxkSNiZFEjRqJbwajttEYX3zwxQcfNDFGiIkao9EHQzSBKPGjgFHEIlJK+Sgt3e5uWyiFQguFdnfGc2e7pUvZ7nTvnZm7M+f3At3d2e7czvmfc8+9c+cOgaLke8VMUKQMJrWhQm1Io1YklCKaQCRBU4WJMPyFBW/68QoJkkIymiBCSoXJHXZ7yk7aB6x0c2clNI5WQnYGdFCEySXQzHRC/qbPkmFwwHq9PgwOoD0AGgf7w3YO+N5Qw+AIRVvDUAHaAqB5Yj/UR40jrk5gqWh7MjHcBYPdnwJZB3wWD4CGiT2e6twzoSM2d86JeKsOQNAOAI0Tey1pLQMu5bLRKAzueQVd8QG4DdoCsHliv2uDfTpIiF5wHLxaWwvLbrgWNuzeC6d6+kFXtANgc1ufYdubiHHwQYAe9ZtdK2Fj1zJJRGugCJKjvPboQxqN/OshmXS+3D0CCaY0aMCiPU9Dw5TboWmwFTRDS6e2ef+gtoN/Mkw2mGt3LIWGae1wuOcAaIR2AGzZ/5Gs5g90Qsqy4KP7GuGK6S3wYfcB0AitJND7F3WAJmufcXx8nTMY8y344KF75IKaLmgDwLaDmhV9MjNiDGrtlhbYsGclpNLpV7xW4yrQAC0A2HbwPyVLvrWIx7UKMkZwz9+2+SH41ZwJG0EDlAZAVe2TT2jdDFoJGd78JtkVanvtdVAcZSXQ1sNfKL/2mQ8+3Gt3lhNFmw4rjrIAaNX5MyHTEWu2LYbPun8GRVESgE/++iLQI38meDFt0/Zl0hhOgyIoJ4E2HfnK9/l9r+CVLs6O1UGRJmNQDKUA6DrRGyjtny9Jy4LXO5dCQ+P9EERQagpkaZb2zERCWpc8hbL1KHsplAFA1/TnlBEbvbf5YQgaKAGATrU/X2w79KVy1yKYI9C2I9/IJQ8hgMGOQVAE3wPQffQ3ee4eBDB4YUwVfJ0C6ZL4ygfTiME7m5bBxaErsxW+fgcgKGnoJ88fPEG+7QC7Tx0IZOufDfz1vj22FOzYBx8A0H3xKxfiRbGvZfFTCAB6jrb5ovNnQ776TvVDyvBnDXQGAMgpD0j7e9ooXWQTYL4BwMueCcufjT/PObAG3wCQ7wCn/KltfRrW0jTQPQBjY1JheFgW5Nj/9Dc+ASD4vX+YDULrEgsRVSXAiYs9rvXnXz1e2vI+XL7yL6hQbYDTxhUJJFGp2RD5lQKNwv6fzGjxq+fvNt/kFwCCxosvN9y0v9d0PQAsffmCaCDnCQaLYLuNfAHAb+3Pjxg0d/8OQ/FYKLDyp9JfAIRB/4+HZ33DyZE2Tz7LcwD8XPtcX1ULm7YvhU3bFkNJHIDnRhiG7IohyBDPMwCCsP6Jcb4YFtS1wLO1bbDGuwEIJ7WOvC67DITZGvA0DZIX4AeqSl3WH/ETzcvhhaZ5UFvp9gggqnSm4/2AMqAPPAWAKw5Bw+I5Z6J9JaydOwdqKrz9qj09LYATnGe2Bj75Rt6kQG5sfg1qSt3zzfpIWcszZSZbIFKaawBC2GDzOQHvKfC0CuQHAJzXJ0KAmbSJqA05VnkCQGFGMJkTnSJmVlp6AoDX5f9cWOHqBlZGpnly77pXAFRkGUgTJYSElDxVJQCiKiM84RUAIUsJxLt+3gAQVhmWZmaMIM2Ju94AEMLpzyihKmJOkHYNQDhSILIzAKCM5DJdA1BZVhEaAJhITVUNOAQjVFaYz3G5BiAMWTFGG8GIrAGHwBUAbnRHlvvXrZoHtPCMtdZY2YPMZavrqwaYLYHzAJSXuJcBT9U2wHtN82CtB+ffZwf3BOueBUkZXE6FXAEQCdnFbkFJg7xz85Vfa0+f5d52/A9oH4mHLi3KVaIWUqQrACpLq0VvnTIJr8yeBasb5kZSn34LJNyTuayHlg8dSqxDOV0B4Fb/cwq/9VglrGiYI0d6J3eMYGmUv27wC2ZpM3SugDsuAYiQTIMYAE6B+E7xG+fOluLWTvH7zFyNBMqnQVYSKJx8+IQbHSBEfb4XxCnQHxfPjI56d0gbAHnEn11Kw8yAQOHwF5MegbKQz8sIfuXMudl37gQ79Yuk5QXJqgpYACCrdnUEK3Pr2qnVcjTnlERylGeRjGCPcE+A2gDwVOir87VaKu6q2lbXFbZciZLuEZYCQF71Uxrz3/dDwu8KW65w1TFo7TjN9J7CX+dJOXzp9GqRVx1jnAiYYrFCFnrBTZCiAKhsqobNs5cJ+bbZMLvNwYDChCkTYqA4AFGuAy6bPlv8fv0MAbZcq5TtXSBnSkQ/XEaFIyS/GHYNx5I8AeDo4PjNQKWvCzZ6DACVm5Uqa5n06YQlNYXNgPTSoCjK6YgYQOirQMyJ8EpqClvY8Vll0qoRWuXyKJOuwSmTX4xKASSLHYe1RCBQE6DKiqj8yLKV/7/EO0BEJUEnXFyg1TIwfSYO1mQcHZbCVjGb2QjwEXMGQOdB1XQFQJTlUOfQBdETXdoM9q5a19AQMC8qE3EpfsFbBODUiE6DBQCgLACdg+cg5yG0e5bXtYxZACsi6rvdDI2AWBZxo9F58pTMg4+5E9BPKEpqY/Ic9A72gc5wfv+TU+dgWf1sCQ1V2ZoIuwFPCVuF1RSrHmZLRrBqGzfOxwb/BfXRuhN0jZ0CvXM+lFUfPvT5m66j0nDwoeY1ETaCyLn9okb8GsGzZw5J33/mEQ2AGOUXxbJhp4+dg67EednbtUF+tXfm18NLjfaWCXJE55GP24eIbZPgn4XNpWWOcRq09eQheZGZ1mMxCXTd9GqYVVZe8PMbKqvgmbomucsCjzAigjMiLJX48a7TR+XSZ8/pY9JhDcIfKANAVVkFzK/LzaZCMdvXH4xdJzuh61QPdI30R3b6FJQ09OZ5Yexvfz8BvWdPwv7Y8SvCNoQ/UArC5XXNBVdxuDAzv36y7c9PoKtI0+AIxYN/QJ4/hbXXG2AbkEUNs9wBELf88QDoOdUD+04fj51OQc7p07HzAzJNvRjXQyWInXrkJPRe7K5x0UZFHx7xXRPx6fPekwdl0tqSFVlTgJDtAnhG3AzGNAF7Mh4UJ8N+9b9WAIyGgP3CfgvfmPtXSK5P+RroZRqS/ufUTaWvHQAM71e9T8Dj9TPt7ZCQ3c9vA02RFw0OUAg3R2KFgztSbGc4nmZpJZ20L5PiQvj46Y8DXJHaONQPhYDnKf9Ap0CX0AUCntLwZGFtVRXcUlUNz/Xtg5M9/VL6cDboJJLCwyDlUwC8R9qTvWEw0wsM5eDXevpVB4C/FM9H+XVWtPmJ1r4wYKgKAPdw3J3qT9o/sGDU2TLDKdCkKFoZBjrU45Uznd9sAwaCHBG4sJOHwL/YzWtFwRkJdLWR3/ajvfHRK9o3+Rro+mUvpkE8N86NM+12uGJWojZe7JYQFIrcGomvAu/UuVE77O7DZcv7eHrDPVwbhUYVlOYqACPOE9/rxdGZbzeLCTAMgYMBYvOlrg18N5vMd/A2i/yZd3tJ52Rr6A5BYFVH/gfVlRXvQ3jR+gAAAABJRU5ErkJggg==">
    <link rel="apple-touch-icon" sizes="167x167" href="data:image/png;base64,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">
    <link rel="apple-touch-icon" sizes="180x180" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAC0CAYAAAA9zQYyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAqnSURBVHgB7Z1dbBRVFMfPndlCAbVQCgXalrIUECT4LYiJxkSNiZFEjRqJbwajttEYX3zwxQcfNDFGiIkao9EHQzSBKPGjgFHEIlJK+Sgt3e5uWyiFQguFdnfGc2e7pUvZ7nTvnZm7M+f3At3d2e7czvmfc8+9c+cOgaLke8VMUKQMJrWhQm1Io1YklCKaQCRBU4WJMPyFBW/68QoJkkIymiBCSoXJHXZ7yk7aB6x0c2clNI5WQnYGdFCEySXQzHRC/qbPkmFwwHq9PgwOoD0AGgf7w3YO+N5Qw+AIRVvDUAHaAqB5Yj/UR40jrk5gqWh7MjHcBYPdnwJZB3wWD4CGiT2e6twzoSM2d86JeKsOQNAOAI0Tey1pLQMu5bLRKAzueQVd8QG4DdoCsHliv2uDfTpIiF5wHLxaWwvLbrgWNuzeC6d6+kFXtANgc1ufYdubiHHwQYAe9ZtdK2Fj1zJJRGugCJKjvPboQxqN/OshmXS+3D0CCaY0aMCiPU9Dw5TboWmwFTRDS6e2ef+gtoN/Mkw2mGt3LIWGae1wuOcAaIR2AGzZ/5Gs5g90Qsqy4KP7GuGK6S3wYfcB0AitJND7F3WAJmufcXx8nTMY8y344KF75IKaLmgDwLaDmhV9MjNiDGrtlhbYsGclpNLpV7xW4yrQAC0A2HbwPyVLvrWIx7UKMkZwz9+2+SH41ZwJG0EDlAZAVe2TT2jdDFoJGd78JtkVanvtdVAcZSXQ1sNfKL/2mQ8+3Gt3lhNFmw4rjrIAaNX5MyHTEWu2LYbPun8GRVESgE/++iLQI38meDFt0/Zl0hhOgyIoJ4E2HfnK9/l9r+CVLs6O1UGRJmNQDKUA6DrRGyjtny9Jy4LXO5dCQ+P9EERQagpkaZb2zERCWpc8hbL1KHsplAFA1/TnlBEbvbf5YQgaKAGATrU/X2w79KVy1yKYI9C2I9/IJQ8hgMGOQVAE3wPQffQ3ee4eBDB4YUwVfJ0C6ZL4ygfTiME7m5bBxaErsxW+fgcgKGnoJ88fPEG+7QC7Tx0IZOufDfz1vj22FOzYBx8A0H3xKxfiRbGvZfFTCAB6jrb5ovNnQ776TvVDyvBnDXQGAMgpD0j7e9ooXWQTYL4BwMueCcufjT/PObAG3wCQ7wCn/KltfRrW0jTQPQBjY1JheFgW5Nj/9Dc+ASD4vX+YDULrEgsRVSXAiYs9rvXnXz1e2vI+XL7yL6hQbYDTxhUJJFGp2RD5lQKNwv6fzGjxq+fvNt/kFwCCxosvN9y0v9d0PQAsffmCaCDnCQaLYLuNfAHAb+3Pjxg0d/8OQ/FYKLDyp9JfAIRB/4+HZ33DyZE2Tz7LcwD8XPtcX1ULm7YvhU3bFkNJHIDnRhiG7IohyBDPMwCCsP6Jcb4YFtS1wLO1bbDGuwEIJ7WOvC67DITZGvA0DZIX4AeqSl3WH/ETzcvhhaZ5UFvp9gggqnSm4/2AMqAPPAWAKw5Bw+I5Z6J9JaydOwdqKrz9qj09LYATnGe2Bj75Rt6kQG5sfg1qSt3zzfpIWcszZSZbIFKaawBC2GDzOQHvKfC0CuQHAJzXJ0KAmbSJqA05VnkCQGFGMJkTnSJmVlp6AoDX5f9cWOHqBlZGpnly77pXAFRkGUgTJYSElDxVJQCiKiM84RUAIUsJxLt+3gAQVhmWZmaMIM2Ju94AEMLpzyihKmJOkHYNQDhSILIzAKCM5DJdA1BZVhEaAJhITVUNOAQjVFaYz3G5BiAMWTFGG8GIrAGHwBUAbnRHlvvXrZoHtPCMtdZY2YPMZavrqwaYLYHzAJSXuJcBT9U2wHtN82CtB+ffZwf3BOueBUkZXE6FXAEQCdnFbkFJg7xz85Vfa0+f5d52/A9oH4mHLi3KVaIWUqQrACpLq0VvnTIJr8yeBasb5kZSn34LJNyTuayHlg8dSqxDOV0B4Fb/cwq/9VglrGiYI0d6J3eMYGmUv27wC2ZpM3SugDsuAYiQTIMYAE6B+E7xG+fOluLWTvH7zFyNBMqnQVYSKJx8+IQbHSBEfb4XxCnQHxfPjI56d0gbAHnEn11Kw8yAQOHwF5MegbKQz8sIfuXMudl37gQ79Yuk5QXJqgpYACCrdnUEK3Pr2qnVcjTnlERylGeRjGCPcE+A2gDwVOir87VaKu6q2lbXFbZciZLuEZYCQF71Uxrz3/dDwu8KW65w1TFo7TjN9J7CX+dJOXzp9GqRVx1jnAiYYrFCFnrBTZCiAKhsqobNs5cJ+bbZMLvNwYDChCkTYqA4AFGuAy6bPlv8fv0MAbZcq5TtXSBnSkQ/XEaFIyS/GHYNx5I8AeDo4PjNQKWvCzZ6DACVm5Uqa5n06YQlNYXNgPTSoCjK6YgYQOirQMyJ8EpqClvY8Vll0qoRWuXyKJOuwSmTX4xKASSLHYe1RCBQE6DKiqj8yLKV/7/EO0BEJUEnXFyg1TIwfSYO1mQcHZbCVjGb2QjwEXMGQOdB1XQFQJTlUOfQBdETXdoM9q5a19AQMC8qE3EpfsFbBODUiE6DBQCgLACdg+cg5yG0e5bXtYxZACsi6rvdDI2AWBZxo9F58pTMg4+5E9BPKEpqY/Ic9A72gc5wfv+TU+dgWf1sCQ1V2ZoIuwFPCVuF1RSrHmZLRrBqGzfOxwb/BfXRuhN0jZ0CvXM+lFUfPvT5m66j0nDwoeY1ETaCyLn9okb8GsGzZw5J33/mEQ2AGOUXxbJhp4+dg67EednbtUF+tXfm18NLjfaWCXJE55GP24eIbZPgn4XNpWWOcRq09eQheZGZ1mMxCXTd9GqYVVZe8PMbKqvgmbomucsCjzAigjMiLJX48a7TR+XSZ8/pY9JhDcIfKANAVVkFzK/LzaZCMdvXH4xdJzuh61QPdI30R3b6FJQ09OZ5Yexvfz8BvWdPwv7Y8SvCNoQ/UArC5XXNBVdxuDAzv36y7c9PoKtI0+AIxYN/QJ4/hbXXG2AbkEUNs9wBELf88QDoOdUD+04fj51OQc7p07HzAzJNvRjXQyWInXrkJPRe7K5x0UZFHx7xXRPx6fPekwdl0tqSFVlTgJDtAnhG3AzGNAF7Mh4UJ8N+9b9WAIyGgP3CfgvfmPtXSK5P+RroZRqS/ufUTaWvHQAM71e9T8Dj9TPt7ZCQ3c9vA02RFw0OUAg3R2KFgztSbGc4nmZpJZ20L5PiQvj46Y8DXJHaONQPhYDnKf9Ap0CX0AUCntLwZGFtVRXcUlUNz/Xtg5M9/VL6cDboJJLCwyDlUwC8R9qTvWEw0wsM5eDXevpVB4C/FM9H+XVWtPmJ1r4wYKgKAPdw3J3qT9o/sGDU2TLDKdCkKFoZBjrU45Uznd9sAwaCHBG4sJOHwL/YzWtFwRkJdLWR3/ajvfHRK9o3+Rro+mUvpkE8N86NM+12uGJWojZe7JYQFIrcGomvAu/UuVE77O7DZcv7eHrDPVwbhUYVlOYqACPOE9/rxdGZbzeLCTAMgYMBYvOlrg18N5vMd/A2i/yZd3tJ52Rr6A5BYFVH/gfVlRXvQ3jR+gAAAABJRU5ErkJggg==">
    
    <!-- Splash Screens pour iOS -->
    <link rel="apple-touch-startup-image" media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUAAAAJACAYAAAD1CiXWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAVnSURBVHgB7dRBDQAhEATB5cMR/AcTQXA2HiCgqgJ2JAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMBHOmJmZ7b0CfzFSh+Ax07HJ/xrCiCJAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBI9AJ2ugJ31Yvo4AAAAABJRU5ErkJggg==">
    <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXoAAAGECAYAAAAmj3KmAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAYgSURBVHgB7dRBDQAhEATB5cMR/AcTQXA2HiCgqgJ2JAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMBHOmJmZ7b0CfzFSh+Ax07HJ/xrCiCJAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBIJAASCYBEAiCRAEgkABIJgEQCIJEASCQAEgmARAIgkQBI9AJ2ugJ31Yvo4AAAAABJRU5ErkJggg==">
    
    <!-- Manifest Web App -->
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIkNoYXRYY2hhbmdlIiwKICAic2hvcnRfbmFtZSI6ICJDaGF0WGNoYW5nZSIsCiAgImljb25zIjogWwogICAgewogICAgICAic3JjIjogImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBT0FBQUFEZ0NBWUFBQUNMWXYrbEFBQUFDWFpJV1hNQUFBc1RBQUFMRXdFQW1wd1lBQUFBQVhOU1IwSUFyczRjNlFBQUFBUm5RVTFCQUFDeGp3djhZUVVBQUFxblNVUkJWSGdCN1oxZGJCUlZGTWZQbmRsQ0FiVlFDZ1hhbHJJVUVDVDRMWWlKeGtTTmlaRkVqUnFKYndhanR0RVlYM3p3eFFjZk5ERkdpSWthbzlFSFF6U0JLUEdqZ0ZIRUlsSkstU2d0M2U1dVd5aUZRZ3VGZCtnY3o1M3RsaTVsdTlPOU4yYnV6UG05UUhmMzdHeXYvdCtuelhWckF4U2srVW9oa3JRaUVVaW9WV2xTaW1oQ0thSjJFUWxHYzdxUUZGSGdMeWg0MDQ5WEVEaUZaSFJBQWdsRXdlQWVTMW5pRHJzOFpTZnNBNVo5ODVZbHJJNVhnWEdUb21rbUVBR1R4Q1JqWVQ2bXo1SUtJNEx5OWJwTUtBRENBdEE0dWg4Mk9EdWsrd01OZ3lNVTZRaERCV2dMZ09ZSi9XQWYxVGppcXdRV0NHbFBHQlZkTU5qOUtiQjF3RmZ4QUdpWU9PQ3ByajBUT21JTDUweVh0K29JQkcwQTBEaXhseVh0TFdBaHQ4MjhnYnZoazhiYUNLdzNjZ010MjBod0ZqUXdIK1Y3SFJ2c00wRkE5SWJqNFdZYlZKU1oyeXZaQXhjbGdJZmdOdWdMZ09ZSi9hNE45dWtnQUIxbHhmV0dnVUhxKzUwZ1VKTDNPT2llU3gydjZndGhvYXN6V0lkeVdnRXdoc21CanV5MEM3UDJCdFAvMlpHMXdXWGdHeEg0MXJjZnJjbUV0dE5INkJoMXJxZDlPQitPaXdrQmVnTFFOTEhQVXVZeVZSK0JNR09uQW4vd241VFFCNUN0Z1c5OUc4QVdnSTJUK3owYjdETkIyTG1ycE9nR3ZqY2dDdnVSOGI3MXZnWnRBZGp5elg2ZHR6NHdScVlqMXU1Y0JuOVpBeXVQT3g0QkxjbDRJMnVEZmdiOER0c09mNkgwMWljZCtIRHYzVmxCVXpDYWhqcTh2QnJLU3FCdGg3NVF2dlg1WTlyc1J3cFlLOW5TdzhOVk1KUUVZTXZCLzVRcy9aY2hEeEVDQm05b1dtY0x2a2xGQUZUVmVla0VxaHUwRWdJV3ZQVkp1UlZyZC8xMVVCeGxKZEhPdzUvclZ2VEpEZ05mYTMrV28wWFRqc09xbzF6TDcrZk9uNDA1WDNYN2xzRm4zVDhEUlZFU2dNOSsvU0x3STE4bWVFSHQ4KzVsc2hHeEIxUkdPUW4wMlpHdmZKL2Y5d3BlNXVMc1dCMGtrV0lpaW9JU0FIU2Q2QTJVOXM4WHFiTGc5YzZsTU5CeGI4Z2lLRE1Gc2hKcFRrUWtwZ0ZKMjVJbmdDMEhHVXVoREFCZDAwK1REUnU5dC9saENFRlFBZ0FkdGIrWXVPM1FsdXBlaW1DT1FOdU9mQ1BYUElRQUJnY0dRUkY4RDBEMTBXL2x1WHZnUStERm9HWHdkUXFrUStLckhNeERrWXc3bTViQitiRXJzcFg4ZmdjZ0tHbm9aODhmUEtGOTJ3RjJuem9ReU5iL2JQRFh1L1pZV3dJLy91ZnR0djJBWEFkQTk4V3ZYSWxIeGE2V3hVOGhBdUFINWpyYTlwWHVudzM1T2ozWkQwblRuL1dxR1FBZ3B6d2c3ZTlwcDNTUjdaajVCZ0F2ZlNZc2Z6YitQT2ZBSW53RFFMNERuUEtuTnZWcFhDdktRUGNBakp1akNoUUhoV1RZLy9RM1BnRWcrcjEvbUIxQjY1SUt3VlVsTGgxOTRGei8vS3ZIUzF2ZWg4dFgvZzJWcWdOdzJyd2lnU1FxTlJzanYwY2dOWTRIZnpLanhhK2V2OXQ4azE4QWlDb3ZmdHhnMC81ZU12VUFzdlRsQzZLaG1DY1lMSUx0TnZJRkFMKzFQejlpME56OU8rekZZNkhXeXA5S2Z3RVFCdjAvSHA3MURTZEgyangvbHVjQStMbjJ1YjZxRmpadFh3cXUyeFlEVVJ5QTUwWVlodXlLSWNnUXp6TUFncUQrS1hDK0V1Ylh0Y0F6dFcydytyL3Z4SXVOYW4wKzQySExzTmlQbXE4QklBVnhRc2xyWCt1cjZtQ1Q5cVd3U2R0aUtJbjc4ZHdJdzVEZE1RUzU0SGtHUUJEV1A1a1g2MkZCWFFzOFc5c0dhendiQlRCU2Ew7Qnc3cm9JZ2ZZVnZBMkRaSVg0Z2FwU2wvVW7ReUo1dVh3UXRNOHFLcHR1Yjh5U0luR2FrR3loTlRPbXVRYWdGRFpZZkU1QWV3bzhyY0o0QVlEaGV5TWdDTS9xbWtnRUwwWTVWbmtDUUdWR01ka1RuYUptVmxwNkFvRFg1ZjljV09IcUJsWkdwbmxuNzdwWEFGUmtHVWdUSWYySEpKUThWU1VBS0VxSnlIaEZRTWhTQi9HdG56Y0FoRldHcFprWkk4aHc0cTQzQUlSdytqTktxSXFZRTZSZEF4Q09GSWpzakFBb0k3bE0xd0JVbGxXRUJnQW0wbEJWQXc3QkNKVVY1bk5jcmdFSVExYU0wVVl3SW12QUlYQUZnQnZka2VYK2RtdU5BUzA4WTYwMVZ2WWdjOW5xK3JJQlprdmdQQURsSk9NeTRLbmFCbml2YVI2czllRDg5dG5CUGNHNlowRlNGcGRUSVZjQVJFSjJzVnRRMGlEdjNIemwxOXJUWjdtM0hmOEQya2Zpb1V1TGNwV29oUlRwQ29ESzBtclJXNmRNd2l1elowSHEabnRWbTM0TEpOeVR1YXlIbGc4ZFNxeERPRjBCNEZiL2N3cS85VmdsckdpWUkwZDZKM2VNWU1td3YyN3dDMlpaTTNTdWdEc3VBWWlRcnZzWUFFNkIrRTd4cStmT2x1TFdUdkg3ekZ5TkJNcW5RVllTS0p4OCtJUWJIU0JFZmI0WHhDamd6K2ZQakk1NmQwZ2JBSHJFbjF0S3c4eUFRTzN4RjVNZWdiS1F6OHNJZHVYTWZ1c09EYnRUdjBoYVhwUXNLVXVCQkFLeWVsWW5zRjNIM3JwMmFyVWN6VGtsa1Z6bGVlUk5ZSS8xcGdOcUE4QlRvYS9KMTJxcGtYdVZlcnRkL2NpVkttQ2U0U3JkcXl3dEJaQWpEK3lBSlRIL25iUTAvQzlXNVFwWEhZUFdqdE5NbWhYK3VrNUs0Y3NuVk91OC9iWEdqUUVybkNsa29Sa093V0VDRktpK3FxcHEyRHg3T1pEdm1qOTc7Y3ZNd1lEQitDc2o0cUY0QUVKVkNqRjA5bXpCOS9WQkJUWWRrNVRwblN4bmlrUi9mQmFWSGdmNHhiekR1RFhjU2ZJRWdLT1Q0emNEbGI0dTJPZ3hBTVJ1V3FxeWxrbVhRbGhTVTlnTXlCVUZpcUljam9nQ2hMNEt4SnpJcjZTbXNJVWRuMTBtb1JxaGJDblFybyt1d1NtVFg0eEtBU1NMSGF0YkloQ29DVkQzaXFqOHlMS1YvN01rT2tCRWRVRWFIRnFnUlRJd1lT44PRGN1OG1RY0haYkNWakR0d0VmTUdRQ2RCMjJ6RHdCV0pUalVPWFJCOTBTWE5vTTl0YTZoSlB3Q0JHRVRjYWxpeXJSRjk1Y0R1alVpMDZBQlFDZ0xRT2ZnT2NoNUNPMlE1WFF0WXhaQWkwankzcmRsd3hNSkdhZVdJam1ZWFNkUHlvejRtSjFBUDZFb3FZMU5jOUE3MkFjNncvWXpKL3RJWDkydGVXMEpEVjNabWdpN0FVOEwxNHk5anFnZVprdUdzQngrN05JNEh4djhGOVNIcXZjWXBmSU5YV09uUU8rWmoyVlZoKzkrOE5ucWkwcUs0Y2VHdjZFMUVUYUN5TEg5b0haOEdaSG5KeHpKMzlGTGh5ODlLQU5BVlZtRmZLckN1TnB1S0JhemZWMUIyWFd5RTdwTzlVRFhTSDlrcDBsQlFVTnZuaGZHOXJidE83VDN6RW5ZRnJzdkowY1hFTFlnUElIWUFGUldWc0NzK3B5OHFpb1VzNzI5dnFwbXZPM3Y5OCt1QnJxS05BMk9VRHo0QitUNVUwaDJ2UUcyQVZGVU16UjNCRVE3ME53TDBIZXFCZmFkUGg0N1hZS2MwejdqNWdmSU5QVmlYQStWSUhicWlaTVFmTGE3emtVYmdhbkg1eFhmTnVHZlB1ODllVkFtclMxWk5qdlRBQkR0QW5oRzNBekdOQUY3TWg0VUo4TnlwaGZHZlV3QmNTRgtXLXdkL1gvMnZGUUNqSVdDL3N0L0NON3Y0Ri9QK0ZaTHJVNTRHZXBtbCtWL2trZFNYdEhqcEJOZlRna2RzQUF3dks3MVB3T1AxTSgzdGtKRE5QOTRHK1JGd1UxQkNJVndjeVJVT2JreXhuYUc0Mm1XVnRHSnZVU0tDK0hqUDYyZ0N1U0cwYzZvTkNjTG5LZKhwMUNYMEFVQ250RHdaIxZLW0VGZFhSWGNVbFFOei9YdGc1TTkvVkw2Y0Rib0pKTEN3eGxsVXdDOFI5eGE2bzMwZ3NPOHdGQU9kcTJuWDNVQStFdnhmSlJmWjBXYm4yTDFqd3dWUUZRUHVJYmo3UngvMVA2QkJhUE9saGxPZ1NSRTBNb3dwUVdPVk01MmZyTUFpRUNPQ0Z6WXlVUGdYK3psdGFMZ2pBUTYyc2h2KzlIZStPZ1Y3WnQ4RFhUOXNoYkprT2ZHZVhHbVMrR0tXWW5hZUxGYlFsQXJjaXNrUG1xaHplRmk3eko3SnZzOXJMZThqNmMzMkFldndhaFFRVmRxQXlTd25MaGNleU5Pam9BN1RiN2RMQ2JBTUFRTUJram1hOTBiK200MmxlL2diUmJWcGQzdE5aMlRyYUU3QklGVkhmNEgxWlVWNzBRNHdmb0FBQUFBQUVsRlRrU3VRbUNDIiwKICAgICAg5XNpemVzIjogIjUxMng1MTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9wbmciCiAgICB9CiAgXSwKICAic3RhcnRfdXJsIjogIi4vaW5kZXguaHRtbCIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiIzVkNWNkZSIsCiAgInRoZW1lX2NvbG9yIjogIiM1ZDVjZGUiLAogICJvcmllbnRhdGlvbiI6ICJwb3J0cmFpdCIKfQo=">

    <style>
        /* Styles de base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        body, html {
            width: 100%;
            height: 100%;
            background-color: #ffffff;
            color: #333333;
            -webkit-overflow-scrolling: touch;
            overflow-x: hidden;
        }

        /* Pour iOS 12 */
        body {
            -webkit-user-select: none;
            user-select: none;
            touch-action: manipulation;
        }

        /* Conteneur principal */
        .container {
            max-width: 500px;
            margin: 0 auto;
            height: 100%;
            display: flex;
            flex-direction: column;
            background-color: #ffffff;
            position: relative;
            box-shadow: 0 0 10px rgba(0,0,0,0.05);
        }

        /* En-tÃªte */
        .header {
            padding: 15px;
            background: linear-gradient(135deg, #5D5CDE, #4C4BAE);
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            z-index: 100;
            position: sticky;
            top: 0;
            height: 60px;
        }

        .header-title {
            font-size: 20px;
            font-weight: 600;
            flex: 1;
            text-align: center;
        }

        .back-button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .back-button:active {
            background-color: rgba(255, 255, 255, 0.2);
        }

        /* Contenu principal */
        .main {
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            padding-bottom: 56px;
            position: relative;
        }

        /* Barre d'onglets */
        .tab-bar {
            display: flex;
            background-color: #ffffff;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 100;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            max-width: 500px;
            margin: 0 auto;
            border-top: 1px solid #eaeaea;
            height: 56px;
        }

        .tab-button {
            flex: 1;
            padding: 8px 0;
            text-align: center;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #777;
        }

        .tab-button.active {
            color: #5D5CDE;
        }

        .tab-button.active:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 20%;
            height: 3px;
            background: linear-gradient(135deg, #5D5CDE, #4C4BAE);
            transform: translateX(-50%);
            border-radius: 3px 3px 0 0;
        }

        .tab-button-icon {
            margin-bottom: 4px;
        }

        .tab-button-label {
            font-size: 12px;
            font-weight: 500;
        }

        /* Ãcran d'authentification */
        .auth-container {
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 20px;
            background: linear-gradient(to bottom, rgba(93, 92, 222, 0.1), rgba(93, 92, 222, 0.05));
        }

        .auth-logo {
            text-align: center;
            margin-bottom: 32px;
        }

        .auth-logo h1 {
            color: #5D5CDE;
            font-size: 32px;
            margin-bottom: 8px;
        }

        .auth-form {
            background-color: #ffffff;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 24px;
            border-bottom: 1px solid #eaeaea;
        }

        .auth-tab {
            flex: 1;
            text-align: center;
            padding: 12px;
            cursor: pointer;
            position: relative;
            font-weight: 500;
        }

        .auth-tab.active {
            color: #5D5CDE;
        }

        .auth-tab.active:after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(135deg, #5D5CDE, #4C4BAE);
        }

        .form-group {
            margin-bottom: 16px;
            position: relative;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333333;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #eaeaea;
            border-radius: 10px;
            font-size: 16px;
            background-color: #ffffff;
            color: #333333;
            -webkit-appearance: none;
            appearance: none;
        }

        .form-input:focus {
            outline: none;
            border-color: #5D5CDE;
            box-shadow: 0 0 0 2px rgba(93, 92, 222, 0.2);
        }

        .btn {
            padding: 14px 16px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            -webkit-appearance: none;
            appearance: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, #5D5CDE, #4C4BAE);
            color: white;
            width: 100%;
        }

        .btn-primary:active {
            background: linear-gradient(135deg, #4C4BAE, #3B3A8D);
        }

        /* Liste de conversations */
        .conversation-list {
            display: flex;
            flex-direction: column;
        }

        .conversation-item {
            display: flex;
            align-items: center;
            padding: 16px;
            cursor: pointer;
            border-bottom: 1px solid #eaeaea;
        }

        .conversation-item:active {
            background-color: #f5f5f5;
        }

        .conversation-avatar {
            width: 52px;
            height: 52px;
            border-radius: 50%;
            background: linear-gradient(135deg, #5D5CDE, #4C4BAE);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 20px;
            margin-right: 14px;
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .conversation-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .conversation-status {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            border: 2px solid #ffffff;
            background-color: #ccc;
        }

        .conversation-status.online {
            background-color: #4CAF50;
        }

        .conversation-content {
            flex: 1;
            overflow: hidden;
        }

        .conversation-name {
            font-weight: 600;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            color: #333333;
        }

        .conversation-message {
            color: #777;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 14px;
        }

        .conversation-meta {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            margin-left: 8px;
        }

        .conversation-time {
            color: #777;
            font-size: 12px;
            white-space: nowrap;
            margin-bottom: 4px;
        }

        .conversation-badge {
            background: linear-gradient(135deg, #5D5CDE, #4C4BAE);
            color: white;
            font-size: 12px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        /* Ãcran de chat */
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            background-color: #f5f5f5;
        }

        .chat-header {
            display: flex;
            align-items: center;
            padding: 15px;
            background: linear-gradient(135deg, #5D5CDE, #4C4BAE);
            color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            z-index: 10;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            max-width: 500px;
            margin: 0 auto;
            height: 60px;
        }

        .chat-title {
            font-weight: 600;
            flex: 1;
            display: flex;
            align-items: center;
        }

        .chat-title-status {
            font-size: 12px;
            font-weight: normal;
            margin-left: 6px;
            opacity: 0.8;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            padding-top: 76px;
            padding-bottom: 76px;
            background-color: #f5f5f5;
            -webkit-overflow-scrolling: touch;
            height: 100%;
        }

        .message-day-separator {
            text-align: center;
            padding: 12px 0;
            position: relative;
            margin: 20px 0;
        }

        .message-day-separator:before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background-color: rgba(0, 0, 0, 0.1);
            z-index: -1;
        }

        .message-day-text {
            background-color: rgba(255, 255, 255, 0.8);
            padding: 4px 12px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 500;
            color: #888;
            display: inline-block;
        }

        .message-group {
            margin-bottom: 8px;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .message-group.sent {
            align-items: flex-end;
        }

        .message-group.received {
            align-items: flex-start;
        }

        .message-bubble {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            margin-bottom: 2px;
            position: relative;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            word-break: break-word;
        }

        .message-sent {
            background: linear-gradient(135deg, #5D5CDE, #4C4BAE);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message-received {
            background-color: #ffffff;
            color: #333333;
            border-bottom-left-radius: 4px;
            border: 1px solid #eaeaea;
        }

        .message-time {
            font-size: 11px;
            opacity: 0.7;
            text-align: right;
            margin-top: 4px;
        }

        .message-sent .message-time {
            color: rgba(255, 255, 255, 0.7);
        }

        .message-status {
            display: inline-flex;
            margin-left: 4px;
        }

        .message-image-container {
            position: relative;
            margin-bottom: 4px;
            border-radius: 8px;
            overflow: hidden;
        }

        .message-image {
            max-width: 250px;
            max-height: 200px;
            display: block;
            border-radius: 8px;
            cursor: pointer;
        }

        .chat-input-container {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            max-width: 500px;
            margin: 0 auto;
            background-color: #ffffff;
            border-top: 1px solid #eaeaea;
            z-index: 100;
            padding: 8px 16px;
            height: 60px;
        }

        .chat-input {
            display: flex;
            align-items: center;
            background-color: #f5f5f5;
            padding: 4px 8px;
            border-radius: 24px;
        }

        .media-button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: none;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #777;
        }

        .media-button:active {
            color: #5D5CDE;
        }

        .message-input-container {
            flex: 1;
            position: relative;
            margin: 0 8px;
        }

        .message-input {
            width: 100%;
            padding: 10px 0;
            border: none;
            border-radius: 0;
            font-size: 16px;
            background: none;
            color: #333333;
        }

        .message-input:focus {
            outline: none;
        }

        .send-button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: none;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #5D5CDE;
        }

        .send-button:active {
            opacity: 0.8;
        }

        /* Liste d'utilisateurs */
        .user-list {
            display: flex;
            flex-direction: column;
        }

        .user-item {
            display: flex;
            align-items: center;
            padding: 16px;
            cursor: pointer;
            border-bottom: 1px solid #eaeaea;
        }

        .user-item:active {
            background-color: #f5f5f5;
        }

        .user-avatar {
            width: 52px;
            height: 52px;
            border-radius: 50%;
            background: linear-gradient(135deg, #5D5CDE, #4C4BAE);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 20px;
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-right: 14px;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .user-info {
            flex: 1;
            overflow: hidden;
        }

        .user-name {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            color: #333333;
        }

        .user-status {
            display: flex;
            align-items: center;
            color: #777;
            font-size: 14px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 6px;
            background-color: #ccc;
        }

        .status-dot.online {
            background-color: #4CAF50;
        }

        /* Profil */
        .profile-container {
            padding-bottom: 80px;
        }

        .profile-header {
            background: linear-gradient(135deg, #5D5CDE, #4C4BAE);
            color: white;
            padding: 30px 20px;
            border-radius: 0 0 16px 16px;
            margin-bottom: 80px;
            position: relative;
            box-shadow: 0 4px 10px rgba(93, 92, 222, 0.3);
        }

        .profile-avatar-container {
            position: absolute;
            bottom: -40px;
            left: 50%;
            transform: translateX(-50%);
            cursor: pointer;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #5D5CDE, #4C4BAE);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 32px;
            border: 4px solid #ffffff;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            position: relative;
        }

        .profile-avatar-edit {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: 12px;
            padding: 4px 0;
            text-align: center;
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-card {
            background-color: #ffffff;
            border-radius: 16px;
            padding: 20px;
            margin: 0 16px 20px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        }

        .profile-card-title {
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            padding-bottom: 8px;
            border-bottom: 1px solid #eaeaea;
            color: #333333;
        }

        .profile-card-title svg {
            margin-right: 10px;
            color: #5D5CDE;
        }

        .profile-field {
            display: flex;
            padding: 12px 0;
            border-bottom: 1px solid #eaeaea;
        }

        .profile-field:last-child {
            border-bottom: none;
        }

        .profile-field-label {
            width: 100px;
            color: #777;
            font-weight: 500;
        }

        .profile-field-value {
            flex: 1;
            font-weight: 500;
            color: #333333;
        }

        .profile-actions {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin: 0 16px;
        }

        .action-button {
            padding: 14px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .action-button svg {
            margin-right: 8px;
        }

        .logout-button {
            border: 1px solid #5D5CDE;
            color: #5D5CDE;
            background-color: transparent;
        }

        .logout-button:active {
            background-color: rgba(93, 92, 222, 0.1);
        }

        .delete-button {
            background: linear-gradient(135deg, #EF4444, #DC2626);
            color: white;
            border: none;
        }

        .delete-button:active {
            background: linear-gradient(135deg, #DC2626, #B91C1C);
        }

        /* Chargement */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            flex-direction: column;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(93, 92, 222, 0.1);
            border-radius: 50%;
            border-top-color: #5D5CDE;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* BanniÃ¨re de notification */
        .banner-notification {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            max-width: 500px;
            margin: 0 auto;
            padding: 16px;
            color: white;
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            border-radius: 0 0 12px 12px;
        }

        .banner-notification.success {
            background: linear-gradient(135deg, #4CAF50, #388E3C);
        }

        .banner-notification.error {
            background: linear-gradient(135deg, #EF4444, #DC2626);
        }

        .banner-notification.warning {
            background: linear-gradient(135deg, #F59E0B, #D97706);
        }

        .banner-notification.info {
            background: linear-gradient(135deg, #3B82F6, #2563EB);
        }

        .banner-content {
            display: flex;
            align-items: center;
            flex: 1;
        }

        .banner-icon {
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            min-width: 28px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
        }

        .banner-message {
            font-weight: 500;
            flex: 1;
        }

        .banner-close {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            opacity: 0.8;
            padding: 4px;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            margin-left: 10px;
        }

        .banner-close:active {
            opacity: 1;
            background-color: rgba(255, 255, 255, 0.2);
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 20px;
            border-radius: 10px;
            color: white;
            background-color: #333;
            z-index: 1000;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            max-width: 90%;
        }

        .toast-icon {
            margin-right: 10px;
        }

        /* Ãtats vides */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            text-align: center;
        }

        .empty-state-icon {
            width: 80px;
            height: 80px;
            color: #ccc;
            margin-bottom: 20px;
        }

        .empty-state-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333333;
        }

        .empty-state-text {
            color: #777;
            max-width: 250px;
        }

        /* Bouton composer */
        .compose-button {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #5D5CDE, #4C4BAE);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(93, 92, 222, 0.3);
            cursor: pointer;
            z-index: 90;
        }

        .compose-button:active {
            background: linear-gradient(135deg, #4C4BAE, #3B3A8D);
        }

        /* Mode sombre (gÃ©rÃ© par JS) */
        .dark-mode {
            background-color: #121212;
            color: #f5f5f5;
        }

        .dark-mode .container {
            background-color: #121212;
        }

        .dark-mode .auth-form,
        .dark-mode .profile-card,
        .dark-mode .chat-input-container,
        .dark-mode .tab-bar {
            background-color: #1e1e1e;
        }

        .dark-mode .form-input {
            background-color: #1e1e1e;
            border-color: #333;
            color: #f5f5f5;
        }

        .dark-mode .chat-messages {
            background-color: #121212;
        }

        .dark-mode .conversation-item,
        .dark-mode .user-item,
        .dark-mode .profile-field {
            border-color: #333;
        }

        .dark-mode .conversation-name,
        .dark-mode .user-name,
        .dark-mode .form-label,
        .dark-mode .profile-field-value,
        .dark-mode .empty-state-title {
            color: #f5f5f5;
        }

        .dark-mode .conversation-message,
        .dark-mode .conversation-time,
        .dark-mode .user-status,
        .dark-mode .profile-field-label,
        .dark-mode .empty-state-text {
            color: #aaa;
        }

        .dark-mode .message-received {
            background-color: #1e1e1e;
            border-color: #333;
            color: #f5f5f5;
        }

        .dark-mode .chat-input {
            background-color: #252525;
        }

        .dark-mode .message-input {
            color: #f5f5f5;
        }

        .dark-mode .empty-state-icon {
            color: #444;
        }

        .dark-mode .message-day-text {
            background-color: rgba(30, 30, 30, 0.8);
        }

        /* Styles supplÃ©mentaires pour iOS 12 */
        input, textarea, select, button {
            font-size: 16px; /* EmpÃªche le zoom sur iOS */
        }

        @media screen and (max-height: 600px) {
            .chat-header {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                z-index: 1000;
            }
            
            .chat-input-container {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                z-index: 1000;
            }
            
            .chat-messages {
                margin-top: 60px;
                margin-bottom: 60px;
                height: calc(100vh - 120px);
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <!-- Firebase SDK avec version compatible pour iOS 12 -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    
    <script>
        // Polyfills pour iOS 12
        if (!Object.entries) {
            Object.entries = function(obj) {
                var ownProps = Object.keys(obj),
                i = ownProps.length,
                entries = new Array(i);
                while (i--) {
                    entries[i] = [ownProps[i], obj[ownProps[i]]];
                }
                return entries;
            };
        }
        
        if (!Array.prototype.find) {
            Object.defineProperty(Array.prototype, 'find', {
                value: function(predicate) {
                    if (this == null) {
                        throw new TypeError('"this" is null or not defined');
                    }
                    var o = Object(this);
                    var len = o.length >>> 0;
                    if (typeof predicate !== 'function') {
                        throw new TypeError('predicate must be a function');
                    }
                    var thisArg = arguments[1];
                    var k = 0;
                    while (k < len) {
                        var kValue = o[k];
                        if (predicate.call(thisArg, kValue, k, o)) {
                            return kValue;
                        }
                        k++;
                    }
                    return undefined;
                }
            });
        }
        
        // Application principale
        var app = {
            currentUser: null,
            currentScreen: 'loading', // loading, auth, main, chat
            currentTab: 'conversations', // conversations, users, profile
            conversations: [],
            filteredConversations: [],
            users: [],
            filteredUsers: [],
            messages: [],
            currentChat: null,
            activeAuthTab: 'login',
            isDarkMode: false,
            notificationTimer: null,
            bannerNotificationTimer: null,
            searchQuery: '',
            
            // Initialiser l'application
            init: function() {
                // Afficher l'Ã©cran de chargement en premier
                this.renderLoadingScreen();
                
                // Ensuite, procÃ©der Ã  la vÃ©rification d'authentification
                this.setupAuthListener();
                
                // VÃ©rifier le mode sombre
                this.checkDarkMode();
                
                // Ãcouter les changements de mode sombre
                this.listenForDarkModeChanges();
            },
            
            // VÃ©rifier le mode sombre
            checkDarkMode: function() {
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    this.isDarkMode = true;
                    document.body.classList.add('dark-mode');
                    return true;
                }
                return false;
            },
            
            // Ãcouter les changements de mode sombre
            listenForDarkModeChanges: function() {
                if (window.matchMedia) {
                    var that = this;
                    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(event) {
                        if (event.matches) {
                            that.isDarkMode = true;
                            document.body.classList.add('dark-mode');
                        } else {
                            that.isDarkMode = false;
                            document.body.classList.remove('dark-mode');
                        }
                    });
                }
            },
            
            // Configurer l'Ã©couteur d'authentification
            setupAuthListener: function() {
                var that = this;
                firebase.auth().onAuthStateChanged(function(user) {
                    if (user) {
                        // L'utilisateur est connectÃ©
                        that.handleUserSignedIn(user);
                    } else {
                        // L'utilisateur est dÃ©connectÃ©
                        that.currentUser = null;
                        that.currentScreen = 'auth';
                        that.render();
                    }
                });
            },
            
            // GÃ©rer l'utilisateur connectÃ©
            handleUserSignedIn: function(user) {
                var that = this;
                // Obtenir le profil utilisateur depuis Firestore
                firebase.firestore().collection('users').doc(user.uid).get()
                    .then(function(userDoc) {
                        if (userDoc.exists) {
                            var userData = userDoc.data();
                            
                            // Mettre Ã  jour le statut en ligne
                            firebase.firestore().collection('users').doc(user.uid).update({
                                online: true,
                                lastSeen: firebase.firestore.Timestamp.now()
                            });
                            
                            // DÃ©finir l'Ã©tat utilisateur
                            that.currentUser = {
                                uid: user.uid,
                                username: userData.username,
                                email: userData.email,
                                phone: userData.phone || "",
                                bio: userData.bio || "",
                                avatar: userData.avatar,
                                blockedUsers: userData.blockedUsers || []
                            };
                            
                            // DÃ©finir l'Ã©cran de l'application
                            that.currentScreen = 'main';
                            
                            // Charger les conversations
                            that.loadConversations();
                            
                            // Charger les utilisateurs
                            that.loadUsers();
                            
                            // Afficher une notification de bienvenue
                            that.showBannerNotification("Bienvenue, " + userData.username + "!", 'success');
                        } else {
                            // Document utilisateur non trouvÃ©, dÃ©connexion
                            firebase.auth().signOut();
                            that.currentUser = null;
                            that.currentScreen = 'auth';
                            that.showBannerNotification('Session expirÃ©e', 'error');
                        }
                        that.render();
                    })
                    .catch(function(error) {
                        console.log("Erreur lors de la rÃ©cupÃ©ration des donnÃ©es utilisateur:", error);
                        that.currentUser = null;
                        that.currentScreen = 'auth';
                        that.showBannerNotification('Erreur de connexion', 'error');
                        that.render();
                    });
            },
            
            // Passer Ã  l'onglet d'authentification
            switchAuthTab: function(tab) {
                this.activeAuthTab = tab;
                this.render();
            },
            
            // GÃ©rer la connexion
            handleLogin: function(event) {
                event.preventDefault();
                
                var email = document.getElementById('login-email').value;
                var password = document.getElementById('login-password').value;
                
                var that = this;
                this.showBannerNotification("Connexion en cours...", "info");
                
                firebase.auth().signInWithEmailAndPassword(email, password)
                    .catch(function(error) {
                        console.log("Erreur de connexion:", error);
                        that.showBannerNotification("Email ou mot de passe incorrect", "error");
                    });
            },
            
            // GÃ©rer l'inscription
            handleRegister: function(event) {
                event.preventDefault();
                
                var username = document.getElementById('register-username').value;
                var email = document.getElementById('register-email').value;
                var phone = document.getElementById('register-phone').value;
                var password = document.getElementById('register-password').value;
                var confirmPassword = document.getElementById('register-confirm-password').value;
                
                // Validation de base
                if (password !== confirmPassword) {
                    this.showBannerNotification("Les mots de passe ne correspondent pas", "error");
                    return;
                }
                
                var that = this;
                this.showBannerNotification("CrÃ©ation du compte...", "info");
                
                // VÃ©rifier si le nom d'utilisateur existe
                firebase.firestore().collection('users')
                    .where('username', '==', username)
                    .get()
                    .then(function(querySnapshot) {
                        if (!querySnapshot.empty) {
                            that.showBannerNotification("Ce nom d'utilisateur est dÃ©jÃ  pris", "error");
                            return;
                        }
                        
                        // CrÃ©er l'utilisateur
                        firebase.auth().createUserWithEmailAndPassword(email, password)
                            .then(function(userCredential) {
                                var user = userCredential.user;
                                
                                // CrÃ©er le document utilisateur
                                return firebase.firestore().collection('users').doc(user.uid).set({
                                    username: username,
                                    email: email,
                                    phone: phone,
                                    bio: "",
                                    avatar: null,
                                    online: true,
                                    lastSeen: firebase.firestore.Timestamp.now(),
                                    createdAt: firebase.firestore.Timestamp.now(),
                                    blockedUsers: []
                                }).then(function() {
                                    // Mettre Ã  jour le profil
                                    return user.updateProfile({
                                        displayName: username
                                    });
                                });
                            })
                            .then(function() {
                                that.showBannerNotification("Compte crÃ©Ã© avec succÃ¨s", "success");
                            })
                            .catch(function(error) {
                                console.log("Erreur d'inscription:", error);
                                that.showBannerNotification("Erreur lors de l'inscription", "error");
                            });
                    })
                    .catch(function(error) {
                        console.log("Erreur lors de la vÃ©rification du nom d'utilisateur:", error);
                        that.showBannerNotification("Erreur lors de l'inscription", "error");
                    });
            },
            
            // GÃ©rer la dÃ©connexion
            handleLogout: function() {
                var that = this;
                this.showBannerNotification("DÃ©connexion en cours...", "info");
                
                if (this.currentUser) {
                    // Mettre Ã  jour le statut en ligne
                    firebase.firestore().collection('users').doc(this.currentUser.uid).update({
                        online: false,
                        lastSeen: firebase.firestore.Timestamp.now()
                    }).then(function() {
                        // DÃ©connexion
                        return firebase.auth().signOut();
                    }).then(function() {
                        that.showBannerNotification("DÃ©connexion rÃ©ussie", "success");
                    }).catch(function(error) {
                        console.log("Erreur de dÃ©connexion:", error);
                        that.showBannerNotification("Erreur lors de la dÃ©connexion", "error");
                    });
                } else {
                    firebase.auth().signOut()
                        .then(function() {
                            that.showBannerNotification("DÃ©connexion rÃ©ussie", "success");
                        })
                        .catch(function(error) {
                            console.log("Erreur de dÃ©connexion:", error);
                            that.showBannerNotification("Erreur lors de la dÃ©connexion", "error");
                        });
                }
            },
            
            // Changer d'onglet dans l'Ã©cran principal
            switchTab: function(tab) {
                this.currentTab = tab;
                this.searchQuery = '';
                this.render();
            },
            
            // Recherche
            handleSearch: function(query) {
                this.searchQuery = query;
                
                if (this.currentTab === 'conversations') {
                    this.filterConversations();
                } else if (this.currentTab === 'users') {
                    this.filterUsers();
                }
                
                this.render();
            },
            
            // Filtrer les conversations en fonction de la recherche
            filterConversations: function() {
                if (!this.searchQuery) {
                    this.filteredConversations = this.conversations;
                    return;
                }
                
                var query = this.searchQuery.toLowerCase();
                var that = this;
                this.filteredConversations = this.conversations.filter(function(conversation) {
                    return conversation.otherUser.username.toLowerCase().includes(query) ||
                           (conversation.lastMessage && conversation.lastMessage.toLowerCase().includes(query));
                });
            },
            
            // Filtrer les utilisateurs en fonction de la recherche
            filterUsers: function() {
                if (!this.searchQuery) {
                    this.filteredUsers = this.users;
                    return;
                }
                
                var query = this.searchQuery.toLowerCase();
                var that = this;
                this.filteredUsers = this.users.filter(function(user) {
                    return user.username.toLowerCase().includes(query) ||
                           (user.phone && user.phone.includes(query)) ||
                           (user.bio && user.bio.toLowerCase().includes(query));
                });
            },
            
            // Effacer la recherche
            clearSearch: function() {
                this.searchQuery = '';
                this.filteredConversations = this.conversations;
                this.filteredUsers = this.users;
                this.render();
            },
            
            // Charger les conversations
            loadConversations: function() {
                var that = this;
                
                try {
                    // Obtenir les conversations oÃ¹ l'utilisateur est un participant
                    var query = firebase.firestore().collection('conversations')
                        .where('participants', 'array-contains', this.currentUser.uid);
                    
                    // Ãcouteur en direct
                    query.onSnapshot(function(snapshot) {
                        var conversations = [];
                        
                        snapshot.forEach(function(doc) {
                            var conversationData = doc.data();
                            
                            // Trouver l'autre participant
                            var otherUserId = conversationData.participants.find(function(id) {
                                return id !== that.currentUser.uid;
                            });
                            
                            // Obtenir les donnÃ©es de l'autre utilisateur
                            firebase.firestore().collection('users').doc(otherUserId).get()
                                .then(function(userDoc) {
                                    if (userDoc.exists) {
                                        var userData = userDoc.data();
                                        
                                        // VÃ©rifier si l'utilisateur est bloquÃ©
                                        var isBlocked = that.currentUser.blockedUsers && 
                                                     that.currentUser.blockedUsers.includes(otherUserId);
                                        
                                        // VÃ©rifier si la conversation est supprimÃ©e pour l'utilisateur actuel
                                        var isDeleted = conversationData.deleted && 
                                                    conversationData.deleted[that.currentUser.uid];
                                        
                                        // N'ajouter que les conversations non supprimÃ©es
                                        if (!isDeleted) {
                                            // Calculer le nombre de messages non lus
                                            var unreadCount = 0;
                                            
                                            // Seulement effectuer cette vÃ©rification s'il y a un dernier message et qu'il n'a pas Ã©tÃ© envoyÃ© par l'utilisateur actuel
                                            if (conversationData.lastMessageSenderId && 
                                                conversationData.lastMessageSenderId !== that.currentUser.uid) {
                                                
                                                // Obtenir les messages non lus
                                                firebase.firestore().collection('messages')
                                                    .where('conversationId', '==', doc.id)
                                                    .where('senderId', '==', otherUserId)
                                                    .where('read', '==', false)
                                                    .get()
                                                    .then(function(unreadQuery) {
                                                        unreadCount = unreadQuery.size;
                                                        
                                                        // Mettre Ã  jour la conversation dans le tableau
                                                        var convIndex = conversations.findIndex(function(c) {
                                                            return c.id === doc.id;
                                                        });
                                                        
                                                        if (convIndex !== -1) {
                                                            conversations[convIndex].unreadCount = unreadCount;
                                                            
                                                            // Trier par horodatage du dernier message
                                                            conversations.sort(function(a, b) {
                                                                return b.lastMessageTimestamp - a.lastMessageTimestamp;
                                                            });
                                                            
                                                            that.conversations = conversations;
                                                            that.filterConversations();
                                                            that.render();
                                                        }
                                                    })
                                                    .catch(function(error) {
                                                        console.log("Erreur lors du comptage des messages non lus:", error);
                                                    });
                                            }
                                            
                                            conversations.push({
                                                id: doc.id,
                                                otherUser: {
                                                    uid: otherUserId,
                                                    username: userData.username,
                                                    avatar: userData.avatar,
                                                    online: userData.online,
                                                    lastSeen: userData.lastSeen ? userData.lastSeen.toDate() : null,
                                                    isBlocked: isBlocked
                                                },
                                                lastMessage: conversationData.lastMessage,
                                                lastMessageType: conversationData.lastMessageType || 'text',
                                                lastMessageTimestamp: conversationData.lastMessageTimestamp ? conversationData.lastMessageTimestamp.toDate() : new Date(),
                                                lastMessageSenderId: conversationData.lastMessageSenderId,
                                                unreadCount: unreadCount,
                                                isBlocked: isBlocked
                                            });
                                            
                                            // Trier par horodatage du dernier message
                                            conversations.sort(function(a, b) {
                                                return b.lastMessageTimestamp - a.lastMessageTimestamp;
                                            });
                                            
                                            that.conversations = conversations;
                                            that.filterConversations();
                                            that.render();
                                        }
                                    }
                                })
                                .catch(function(error) {
                                    console.log("Erreur lors de la rÃ©cupÃ©ration de l'utilisateur " + otherUserId + ":", error);
                                });
                        });
                    }, function(error) {
                        console.log("Erreur lors du chargement des conversations:", error);
                        that.showBannerNotification("Erreur lors du chargement des conversations", "error");
                    });
                    
                } catch (error) {
                    console.log("Erreur lors du chargement des conversations:", error);
                    this.showBannerNotification("Erreur lors du chargement des conversations", "error");
                }
            },
            
            // Supprimer une conversation (pour l'utilisateur actuel uniquement)
            deleteConversation: function(conversationId) {
                var that = this;
                try {
                    var conversationRef = firebase.firestore().collection('conversations').doc(conversationId);
                    conversationRef.get().then(function(conversationDoc) {
                        if (conversationDoc.exists) {
                            // Marquer la conversation comme supprimÃ©e pour l'utilisateur actuel
                            var deleted = conversationDoc.data().deleted || {};
                            deleted[that.currentUser.uid] = true;
                            
                            conversationRef.update({ deleted: deleted }).then(function() {
                                that.showBannerNotification("Conversation supprimÃ©e", "success");
                                
                                // Si dans l'Ã©cran de chat, revenir Ã  l'Ã©cran principal
                                if (that.currentScreen === 'chat' && that.currentChat && that.currentChat.id === conversationId) {
                                    that.currentScreen = 'main';
                                    that.currentChat = null;
                                    that.render();
                                }
                            });
                        }
                    }).catch(function(error) {
                        console.log("Erreur lors de la suppression de la conversation:", error);
                        that.showBannerNotification("Erreur lors de la suppression", "error");
                    });
                } catch (error) {
                    console.log("Erreur lors de la suppression de la conversation:", error);
                    this.showBannerNotification("Erreur lors de la suppression", "error");
                }
            },
            
            // Charger les utilisateurs
            loadUsers: function() {
                var that = this;
                try {
                    // Obtenir tous les utilisateurs
                    firebase.firestore().collection('users').get()
                        .then(function(snapshot) {
                            var users = [];
                            
                            snapshot.forEach(function(doc) {
                                // Ne pas inclure l'utilisateur actuel
                                if (doc.id !== that.currentUser.uid) {
                                    var userData = doc.data();
                                    
                                    // VÃ©rifier si l'utilisateur est bloquÃ©
                                    var isBlocked = that.currentUser.blockedUsers && 
                                                 that.currentUser.blockedUsers.includes(doc.id);
                                    
                                    users.push({
                                        uid: doc.id,
                                        username: userData.username,
                                        email: userData.email,
                                        phone: userData.phone || "",
                                        bio: userData.bio || "",
                                        avatar: userData.avatar,
                                        online: userData.online,
                                        lastSeen: userData.lastSeen ? userData.lastSeen.toDate() : null,
                                        isBlocked: isBlocked
                                    });
                                }
                            });
                            
                            that.users = users;
                            that.filteredUsers = users;
                            that.render();
                            
                            // Configurer l'Ã©couteur pour les mises Ã  jour de statut en ligne
                            that.setupOnlineStatusListener();
                        })
                        .catch(function(error) {
                            console.log("Erreur lors du chargement des utilisateurs:", error);
                            that.showBannerNotification("Erreur lors du chargement des utilisateurs", "error");
                        });
                } catch (error) {
                    console.log("Erreur lors du chargement des utilisateurs:", error);
                    this.showBannerNotification("Erreur lors du chargement des utilisateurs", "error");
                }
            },
            
            // Configurer l'Ã©couteur de statut en ligne
            setupOnlineStatusListener: function() {
                var that = this;
                // Ãcouter les changements de statut en ligne des utilisateurs
                firebase.firestore().collection('users').onSnapshot(function(snapshot) {
                    snapshot.docChanges().forEach(function(change) {
                        // Ignorer l'utilisateur actuel
                        if (change.doc.id === that.currentUser.uid) return;
                        
                        var userData = change.doc.data();
                        
                        // Mettre Ã  jour la liste des utilisateurs
                        that.users = that.users.map(function(user) {
                            if (user.uid === change.doc.id) {
                                return {
                                    uid: user.uid,
                                    username: user.username,
                                    email: user.email,
                                    phone: user.phone,
                                    bio: user.bio,
                                    avatar: user.avatar,
                                    online: userData.online,
                                    lastSeen: userData.lastSeen ? userData.lastSeen.toDate() : user.lastSeen,
                                    isBlocked: user.isBlocked
                                };
                            }
                            return user;
                        });
                        
                        // Mettre Ã  jour la liste des conversations
                        that.conversations = that.conversations.map(function(conversation) {
                            if (conversation.otherUser.uid === change.doc.id) {
                                return {
                                    id: conversation.id,
                                    otherUser: {
                                        uid: conversation.otherUser.uid,
                                        username: conversation.otherUser.username,
                                        avatar: conversation.otherUser.avatar,
                                        online: userData.online,
                                        lastSeen: userData.lastSeen ? userData.lastSeen.toDate() : conversation.otherUser.lastSeen,
                                        isBlocked: conversation.otherUser.isBlocked
                                    },
                                    lastMessage: conversation.lastMessage,
                                    lastMessageType: conversation.lastMessageType,
                                    lastMessageTimestamp: conversation.lastMessageTimestamp,
                                    lastMessageSenderId: conversation.lastMessageSenderId,
                                    unreadCount: conversation.unreadCount,
                                    isBlocked: conversation.isBlocked
                                };
                            }
                            return conversation;
                        });
                        
                        // Mettre Ã  jour le chat actuel si nÃ©cessaire
                        if (that.currentChat && that.currentChat.otherUser.uid === change.doc.id) {
                            that.currentChat = {
                                id: that.currentChat.id,
                                otherUser: {
                                    uid: that.currentChat.otherUser.uid,
                                    username: that.currentChat.otherUser.username,
                                    avatar: that.currentChat.otherUser.avatar,
                                    online: userData.online,
                                    lastSeen: userData.lastSeen ? userData.lastSeen.toDate() : that.currentChat.otherUser.lastSeen,
                                    isBlocked: that.currentChat.otherUser.isBlocked
                                }
                            };
                        }
                    });
                    
                    // Re-filtrer et rendre
                    that.filterUsers();
                    that.filterConversations();
                    that.render();
                }, function(error) {
                    console.log("Erreur lors de l'Ã©coute des changements de statut en ligne:", error);
                });
            },
            
            // DÃ©marrer un chat avec un utilisateur
            startChat: function(user) {
                var that = this;
                if (user.isBlocked) {
                    this.showBannerNotification("Vous avez bloquÃ© cet utilisateur", "warning");
                    return;
                }
                
                // CrÃ©er l'ID de conversation (trier les UID pour assurer la cohÃ©rence)
                var sortedIds = [this.currentUser.uid, user.uid].sort();
                var conversationId = sortedIds.join('_');
                
                try {
                    // VÃ©rifier si la conversation existe
                    firebase.firestore().collection('conversations').doc(conversationId).get()
                        .then(function(conversationDoc) {
                            if (!conversationDoc.exists) {
                                // CrÃ©er une nouvelle conversation
                                return firebase.firestore().collection('conversations').doc(conversationId).set({
                                    participants: sortedIds,
                                    lastMessage: null,
                                    lastMessageTimestamp: firebase.firestore.Timestamp.now(),
                                    createdAt: firebase.firestore.Timestamp.now(),
                                    deleted: {}
                                });
                            } else {
                                // Si la conversation existe mais a Ã©tÃ© supprimÃ©e pour l'utilisateur actuel, la rÃ©tablir
                                if (conversationDoc.data().deleted && conversationDoc.data().deleted[that.currentUser.uid]) {
                                    var deleted = conversationDoc.data().deleted;
                                    deleted[that.currentUser.uid] = false;
                                    return firebase.firestore().collection('conversations').doc(conversationId).update({ deleted: deleted });
                                }
                                return Promise.resolve();
                            }
                        })
                        .then(function() {
                            // Ouvrir l'Ã©cran de chat
                            that.currentChat = {
                                id: conversationId,
                                otherUser: user
                            };
                            
                            that.currentScreen = 'chat';
                            
                            // Charger les messages
                            that.loadMessages(conversationId);
                            
                            that.render();
                        })
                        .catch(function(error) {
                            console.log("Erreur lors du dÃ©marrage du chat:", error);
                            that.showBannerNotification("Erreur lors du dÃ©marrage de la conversation", "error");
                        });
                } catch (error) {
                    console.log("Erreur lors du dÃ©marrage du chat:", error);
                    this.showBannerNotification("Erreur lors du dÃ©marrage de la conversation", "error");
                }
            },
            
            // Charger les messages d'une conversation
            loadMessages: function(conversationId) {
                var that = this;
                try {
                    // Effacer les messages prÃ©cÃ©dents
                    this.messages = [];
                    
                    // RequÃªte pour les messages
                    var query = firebase.firestore().collection('messages')
                        .where('conversationId', '==', conversationId)
                        .orderBy('timestamp', 'asc');
                    
                    // Ãcouteur en direct
                    query.onSnapshot(function(snapshot) {
                        var messages = [];
                        
                        snapshot.forEach(function(doc) {
                            var messageData = doc.data();
                            
                            // Ignorer les messages cachÃ©s pour l'utilisateur actuel
                            if (messageData.hidden && messageData.hidden[that.currentUser.uid]) {
                                return;
                            }
                            
                            messages.push({
                                id: doc.id,
                                senderId: messageData.senderId,
                                text: messageData.text,
                                image: messageData.image,
                                messageType: messageData.messageType || 'text',
                                timestamp: messageData.timestamp ? messageData.timestamp.toDate() : new Date(),
                                read: messageData.read,
                                edited: messageData.edited || false
                            });
                        });
                        
                        that.messages = messages;
                        that.render();
                        
                        // Faire dÃ©filer vers le bas
                        that.scrollToBottom();
                        
                        // Marquer les messages comme lus
                        that.markMessagesAsRead(conversationId);
                    }, function(error) {
                        console.log("Erreur lors du chargement des messages:", error);
                        that.showBannerNotification("Erreur lors du chargement des messages", "error");
                    });
                    
                } catch (error) {
                    console.log("Erreur lors du chargement des messages:", error);
                    this.showBannerNotification("Erreur lors du chargement des messages", "error");
                }
            },
            
            // Marquer les messages comme lus
            markMessagesAsRead: function(conversationId) {
                var that = this;
                try {
                    // Obtenir les messages non lus non envoyÃ©s par l'utilisateur actuel
                    firebase.firestore().collection('messages')
                        .where('conversationId', '==', conversationId)
                        .where('senderId', '!=', this.currentUser.uid)
                        .where('read', '==', false)
                        .get()
                        .then(function(snapshot) {
                            // Mise Ã  jour par lot
                            var batch = firebase.firestore().batch();
                            
                            snapshot.forEach(function(doc) {
                                batch.update(doc.ref, { read: true });
                            });
                            
                            if (snapshot.size > 0) {
                                return batch.commit();
                            }
                        })
                        .catch(function(error) {
                            console.log("Erreur lors du marquage des messages comme lus:", error);
                        });
                } catch (error) {
                    console.log("Erreur lors du marquage des messages comme lus:", error);
                }
            },
            
            // Envoyer un message
            sendMessage: function() {
                var that = this;
                if (!this.currentChat) return;
                
                var messageInput = document.getElementById('message-input');
                var text = messageInput ? messageInput.value.trim() : '';
                
                // VÃ©rifier s'il y a du texte
                if (!text) return;
                
                try {
                    // PrÃ©parer les donnÃ©es du message
                    var messageData = {
                        conversationId: this.currentChat.id,
                        senderId: this.currentUser.uid,
                        text: text,
                        timestamp: firebase.firestore.Timestamp.now(),
                        read: false,
                        edited: false,
                        hidden: {}
                    };
                    
                    // Envoyer le message Ã  Firestore
                    firebase.firestore().collection('messages').add(messageData)
                        .then(function(messageRef) {
                            // Mettre Ã  jour la conversation avec les informations du dernier message
                            return firebase.firestore().collection('conversations').doc(that.currentChat.id).update({
                                lastMessage: text,
                                lastMessageType: 'text',
                                lastMessageTimestamp: firebase.firestore.Timestamp.now(),
                                lastMessageSenderId: that.currentUser.uid
                            });
                        })
                        .then(function() {
                            // Effacer l'input
                            if (messageInput) {
                                messageInput.value = '';
                            }
                        })
                        .catch(function(error) {
                            console.log("Erreur lors de l'envoi du message:", error);
                            that.showBannerNotification("Erreur lors de l'envoi du message", "error");
                        });
                } catch (error) {
                    console.log("Erreur lors de l'envoi du message:", error);
                    this.showBannerNotification("Erreur lors de l'envoi du message", "error");
                }
            },
            
            // Bloquer/dÃ©bloquer un utilisateur
            toggleBlockUser: function(userId, shouldBlock) {
                var that = this;
                try {
                    if (!this.currentUser) return;
                    
                    var userRef = firebase.firestore().collection('users').doc(this.currentUser.uid);
                    userRef.get().then(function(userDoc) {
                        if (userDoc.exists) {
                            var userData = userDoc.data();
                            var blockedUsers = userData.blockedUsers || [];
                            
                            if (shouldBlock) {
                                // Ajouter Ã  la liste des bloquÃ©s s'il n'y est pas dÃ©jÃ 
                                if (!blockedUsers.includes(userId)) {
                                    blockedUsers.push(userId);
                                }
                            } else {
                                // Retirer de la liste des bloquÃ©s
                                blockedUsers = blockedUsers.filter(function(id) { return id !== userId; });
                            }
                            
                            // Mettre Ã  jour le document utilisateur
                            return userRef.update({ blockedUsers: blockedUsers });
                        }
                    }).then(function() {
                        // Mettre Ã  jour l'Ã©tat local
                        that.currentUser.blockedUsers = that.currentUser.blockedUsers || [];
                        
                        if (shouldBlock) {
                            if (!that.currentUser.blockedUsers.includes(userId)) {
                                that.currentUser.blockedUsers.push(userId);
                            }
                        } else {
                            that.currentUser.blockedUsers = that.currentUser.blockedUsers.filter(function(id) {
                                return id !== userId;
                            });
                        }
                        
                        // Mettre Ã  jour l'UI pour toutes les conversations ou utilisateurs qui sont maintenant bloquÃ©s/dÃ©bloquÃ©s
                        that.users = that.users.map(function(user) {
                            if (user.uid === userId) {
                                return { 
                                    uid: user.uid,
                                    username: user.username,
                                    email: user.email,
                                    phone: user.phone,
                                    bio: user.bio,
                                    avatar: user.avatar,
                                    online: user.online,
                                    lastSeen: user.lastSeen,
                                    isBlocked: shouldBlock
                                };
                            }
                            return user;
                        });
                        
                        that.conversations = that.conversations.map(function(conversation) {
                            if (conversation.otherUser.uid === userId) {
                                return { 
                                    id: conversation.id,
                                    otherUser: {
                                        uid: conversation.otherUser.uid,
                                        username: conversation.otherUser.username,
                                        avatar: conversation.otherUser.avatar,
                                        online: conversation.otherUser.online,
                                        lastSeen: conversation.otherUser.lastSeen,
                                        isBlocked: shouldBlock
                                    },
                                    lastMessage: conversation.lastMessage,
                                    lastMessageType: conversation.lastMessageType,
                                    lastMessageTimestamp: conversation.lastMessageTimestamp,
                                    lastMessageSenderId: conversation.lastMessageSenderId,
                                    unreadCount: conversation.unreadCount,
                                    isBlocked: shouldBlock
                                };
                            }
                            return conversation;
                        });
                        
                        // Filtrer les conversations et les utilisateurs
                        that.filterConversations();
                        that.filterUsers();
                        
                        // Mettre Ã  jour le chat actuel si nÃ©cessaire
                        if (that.currentChat && that.currentChat.otherUser.uid === userId) {
                            that.currentChat = {
                                id: that.currentChat.id,
                                otherUser: {
                                    uid: that.currentChat.otherUser.uid,
                                    username: that.currentChat.otherUser.username,
                                    avatar: that.currentChat.otherUser.avatar,
                                    online: that.currentChat.otherUser.online,
                                    lastSeen: that.currentChat.otherUser.lastSeen,
                                    isBlocked: shouldBlock
                                }
                            };
                        }
                        
                        that.showBannerNotification(
                            shouldBlock ? "Utilisateur bloquÃ©" : "Utilisateur dÃ©bloquÃ©", 
                            "success"
                        );
                        
                        that.render();
                    }).catch(function(error) {
                        console.log("Erreur lors du blocage/dÃ©blocage de l'utilisateur:", error);
                        that.showBannerNotification("Erreur lors de l'action", "error");
                    });
                } catch (error) {
                    console.log("Erreur lors du blocage/dÃ©blocage de l'utilisateur:", error);
                    this.showBannerNotification("Erreur lors de l'action", "error");
                }
            },
            
            // Obtenir les initiales pour l'avatar par dÃ©faut
            getInitials: function(name) {
                return name ? name.charAt(0).toUpperCase() : '?';
            },
            
            // Faire dÃ©filer le chat vers le bas
            scrollToBottom: function() {
                var chatMessages = document.getElementById('chat-messages');
                if (chatMessages) {
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }
            },
            
            // Formatter l'heure pour l'affichage
            formatTime: function(timestamp) {
                if (!timestamp) return '';
                
                var now = new Date();
                var date = timestamp instanceof Date ? timestamp : new Date(timestamp);
                
                // Si c'est aujourd'hui, afficher l'heure
                if (date.toDateString() === now.toDateString()) {
                    return date.getHours() + ':' + (date.getMinutes() < 10 ? '0' : '') + date.getMinutes();
                }
                
                // Si c'est hier, afficher 'Hier'
                var yesterday = new Date(now);
                yesterday.setDate(now.getDate() - 1);
                if (date.toDateString() === yesterday.toDateString()) {
                    return 'Hier';
                }
                
                // Si c'est cette semaine, afficher le nom du jour
                if (now.getTime() - date.getTime() < 7 * 24 * 60 * 60 * 1000) {
                    var days = ['Dim', 'Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam'];
                    return days[date.getDay()];
                }
                
                // Sinon, afficher la date
                return date.getDate() + '/' + (date.getMonth() + 1);
            },
            
            // Formatter la date complÃ¨te
            formatFullDate: function(timestamp) {
                if (!timestamp) return '';
                var date = timestamp instanceof Date ? timestamp : new Date(timestamp);
                
                var days = ['Dimanche', 'Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi'];
                var months = ['Janvier', 'FÃ©vrier', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'AoÃ»t', 'Septembre', 'Octobre', 'Novembre', 'DÃ©cembre'];
                
                return days[date.getDay()] + ' ' + date.getDate() + ' ' + months[date.getMonth()] + ' ' + date.getFullYear();
            },
            
            // Formatter la derniÃ¨re connexion
            formatLastSeen: function(lastSeen) {
                if (!lastSeen) return 'Jamais connectÃ©';
                
                var date = lastSeen instanceof Date ? lastSeen : new Date(lastSeen);
                var now = new Date();
                var diff = now - date;
                
                // Moins d'une minute
                if (diff < 60000) {
                    return 'Ã l\'instant';
                }
                
                // Moins d'une heure
                if (diff < 3600000) {
                    var minutes = Math.floor(diff / 60000);
                    return 'Il y a ' + minutes + ' minute' + (minutes > 1 ? 's' : '');
                }
                
                // Moins d'un jour
                if (diff < 86400000) {
                    var hours = Math.floor(diff / 3600000);
                    return 'Il y a ' + hours + ' heure' + (hours > 1 ? 's' : '');
                }
                
                // Moins d'une semaine
                if (diff < 604800000) {
                    var days = Math.floor(diff / 86400000);
                    return 'Il y a ' + days + ' jour' + (days > 1 ? 's' : '');
                }
                
                // Formatter en date
                return date.getDate() + '/' + (date.getMonth() + 1) + '/' + date.getFullYear();
            },
            
            // Afficher une notification toast
            showNotification: function(message, type) {
                // Effacer la notification existante
                if (this.notificationTimer) {
                    clearTimeout(this.notificationTimer);
                    var existingToast = document.querySelector('.toast');
                    if (existingToast) {
                        existingToast.parentNode.removeChild(existingToast);
                    }
                }
                
                // CrÃ©er l'Ã©lÃ©ment toast
                var toast = document.createElement('div');
                toast.className = 'toast ' + type;
                
                // Ajouter une icÃ´ne en fonction du type
                var icon = '';
                switch(type) {
                    case 'success':
                        icon = '<svg class="toast-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 13L9 17L19 7" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
                        break;
                    case 'error':
                        icon = '<svg class="toast-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6L6 18M6 6L18 18" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
                        break;
                    case 'warning':
                        icon = '<svg class="toast-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 9V13M12 17H12.01M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
                        break;
                    default:
                        icon = '<svg class="toast-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 16H12V12H11M12 8H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
                }
                
                toast.innerHTML = icon + '<span>' + message + '</span>';
                
                // Ajouter au DOM
                document.body.appendChild(toast);
                
                // Supprimer automatiquement aprÃ¨s 3 secondes
                this.notificationTimer = setTimeout(function() {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 3000);
            },
            
            // Afficher une notification banniÃ¨re
            showBannerNotification: function(message, type) {
                // Supprimer la banniÃ¨re existante
                this.closeBannerNotification();
                
                // CrÃ©er l'Ã©lÃ©ment banniÃ¨re
                var banner = document.createElement('div');
                banner.className = 'banner-notification ' + type;
                
                // Ajouter une icÃ´ne en fonction du type
                var icon = '';
                switch(type) {
                    case 'success':
                        icon = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 13L9 17L19 7" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
                        break;
                    case 'error':
                        icon = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6L6 18M6 6L18 18" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
                        break;
                    case 'warning':
                        icon = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 9V13M12 17H12.01M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
                        break;
                    default:
                        icon = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 16H12V12H11M12 8H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
                }
                
                banner.innerHTML = '<div class="banner-content"><div class="banner-icon">' + icon + '</div><div class="banner-message">' + message + '</div></div><button class="banner-close"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>';
                
                // Ajouter au DOM
                document.body.appendChild(banner);
                
                // Configurer le bouton de fermeture
                var closeButton = banner.querySelector('.banner-close');
                var that = this;
                if (closeButton) {
                    closeButton.addEventListener('click', function() {
                        that.closeBannerNotification();
                    });
                }
                
                // Fermer automatiquement aprÃ¨s 5 secondes
                this.bannerNotificationTimer = setTimeout(function() {
                    that.closeBannerNotification();
                }, 5000);
            },
            
            // Fermer la notification banniÃ¨re
            closeBannerNotification: function() {
                clearTimeout(this.bannerNotificationTimer);
                var existingBanner = document.querySelector('.banner-notification');
                if (existingBanner) {
                    existingBanner.parentNode.removeChild(existingBanner);
                }
            },
            
            // Rendre l'Ã©cran de chargement
            renderLoadingScreen: function() {
                var appElement = document.getElementById('app');
                if (!appElement) return;
                
                appElement.innerHTML = '<div class="loading"><h1 style="margin-bottom: 20px; color: #5D5CDE;">ChatXchange</h1><div class="spinner"></div></div>';
            },
            
            // Rendre l'Ã©cran d'authentification
            renderAuthScreen: function() {
                return '<div class="auth-container">' +
                    '<div class="auth-logo">' +
                        '<h1>ChatXchange</h1>' +
                        '<p>La plateforme d\'Ã©change sÃ©curisÃ©e</p>' +
                    '</div>' +
                    '<div class="auth-form">' +
                        '<div class="auth-tabs">' +
                            '<div class="auth-tab ' + (this.activeAuthTab === 'login' ? 'active' : '') + '" onclick="app.switchAuthTab(\'login\')">Connexion</div>' +
                            '<div class="auth-tab ' + (this.activeAuthTab === 'register' ? 'active' : '') + '" onclick="app.switchAuthTab(\'register\')">Inscription</div>' +
                        '</div>' +
                        (this.activeAuthTab === 'login' ? this.renderLoginForm() : this.renderRegisterForm()) +
                    '</div>' +
                '</div>';
            },
            
            // Rendre le formulaire de connexion
            renderLoginForm: function() {
                return '<form id="login-form" onsubmit="app.handleLogin(event)">' +
                    '<div class="form-group">' +
                        '<label class="form-label" for="login-email">Email</label>' +
                        '<input type="email" id="login-email" class="form-input" required autocomplete="email">' +
                    '</div>' +
                    '<div class="form-group">' +
                        '<label class="form-label" for="login-password">Mot de passe</label>' +
                        '<input type="password" id="login-password" class="form-input" required autocomplete="current-password">' +
                    '</div>' +
                    '<div style="text-align: right; margin-bottom: 16px;">' +
                        '<a href="#" style="color: #5D5CDE; font-size: 14px;">Mot de passe oubliÃ© ?</a>' +
                    '</div>' +
                    '<button type="submit" class="btn btn-primary">Se connecter</button>' +
                '</form>';
            },
            
            // Rendre le formulaire d'inscription
            renderRegisterForm: function() {
                return '<form id="register-form" onsubmit="app.handleRegister(event)">' +
                    '<div class="form-group">' +
                        '<label class="form-label" for="register-username">Nom d\'utilisateur</label>' +
                        '<input type="text" id="register-username" class="form-input" required autocomplete="username">' +
                    '</div>' +
                    '<div class="form-group">' +
                        '<label class="form-label" for="register-email">Email</label>' +
                        '<input type="email" id="register-email" class="form-input" required autocomplete="email">' +
                    '</div>' +
                    '<div class="form-group">' +
                        '<label class="form-label" for="register-phone">TÃ©lÃ©phone</label>' +
                        '<input type="tel" id="register-phone" class="form-input" required autocomplete="tel">' +
                    '</div>' +
                    '<div class="form-group">' +
                        '<label class="form-label" for="register-password">Mot de passe</label>' +
                        '<input type="password" id="register-password" class="form-input" required autocomplete="new-password">' +
                    '</div>' +
                    '<div class="form-group">' +
                        '<label class="form-label" for="register-confirm-password">Confirmer le mot de passe</label>' +
                        '<input type="password" id="register-confirm-password" class="form-input" required autocomplete="new-password">' +
                    '</div>' +
                    '<button type="submit" class="btn btn-primary">S\'inscrire</button>' +
                '</form>';
            },
            
            // Rendre l'Ã©cran principal
            renderMainScreen: function() {
                return '<div class="container">' +
                    (this.currentTab === 'conversations' ? this.renderConversationsTab() : '') +
                    (this.currentTab === 'users' ? this.renderUsersTab() : '') +
                    (this.currentTab === 'profile' ? this.renderProfileTab() : '') +
                    (this.currentTab === 'conversations' ? '<div class="compose-button" onclick="app.switchTab(\'users\')"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5V19M5 12H19" /></svg></div>' : '') +
                    '<div class="tab-bar">' +
                        '<div class="tab-button ' + (this.currentTab === 'conversations' ? 'active' : '') + '" onclick="app.switchTab(\'conversations\')">' +
                            '<svg class="tab-button-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">' +
                                '<path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>' +
                            '</svg>' +
                            '<span class="tab-button-label">Discussions</span>' +
                        '</div>' +
                        '<div class="tab-button ' + (this.currentTab === 'users' ? 'active' : '') + '" onclick="app.switchTab(\'users\')">' +
                            '<svg class="tab-button-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">' +
                                '<path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>' +
                                '<circle cx="9" cy="7" r="4"></circle>' +
                                '<path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>' +
                                '<path d="M16 3.13a4 4 0 0 1 0 7.75"></path>' +
                            '</svg>' +
                            '<span class="tab-button-label">Utilisateurs</span>' +
                        '</div>' +
                        '<div class="tab-button ' + (this.currentTab === 'profile' ? 'active' : '') + '" onclick="app.switchTab(\'profile\')">' +
                            '<svg class="tab-button-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">' +
                                '<path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>' +
                                '<circle cx="12" cy="7" r="4"></circle>' +
                            '</svg>' +
                            '<span class="tab-button-label">Profil</span>' +
                        '</div>' +
                    '</div>' +
                '</div>';
            },
            
            // Rendre l'onglet Conversations
            renderConversationsTab: function() {
                var searchHtml = '<div style="padding: 8px 16px;">' +
                    '<div style="display: flex; align-items: center; background-color: #f5f5f5; border-radius: 10px; padding: 8px 12px;">' +
                        '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#777" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">' +
                            '<circle cx="11" cy="11" r="8"></circle>' +
                            '<line x1="21" y1="21" x2="16.65" y2="16.65"></line>' +
                        '</svg>' +
                        '<input type="text" class="form-input" placeholder="Rechercher..." value="' + this.searchQuery + '" oninput="app.handleSearch(this.value)" style="border: none; background: none; width: 100%; font-size: 16px;">' +
                        (this.searchQuery ? '<button onclick="app.clearSearch()" style="background: none; border: none; color: #777; padding: 4px;"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>' : '') +
                    '</div>' +
                '</div>';
                
                return '<div class="header">' +
                    '<h1 class="header-title">Discussions</h1>' +
                '</div>' + 
                searchHtml +
                '<div class="main">' +
                    (this.filteredConversations.length === 0 ? this.renderEmptyConversations() : this.renderConversationsList()) +
                '</div>';
            },
            
            // Rendre l'Ã©tat vide des conversations
            renderEmptyConversations: function() {
                if (this.searchQuery) {
                    return '<div class="empty-state">' +
                        '<div class="empty-state-icon">' +
                            '<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">' +
                                '<circle cx="11" cy="11" r="8"></circle>' +
                                '<line x1="21" y1="21" x2="16.65" y2="16.65"></line>' +
                            '</svg>' +
                        '</div>' +
                        '<h3 class="empty-state-title">Aucun rÃ©sultat</h3>' +
                        '<p class="empty-state-text">Aucune conversation ne correspond Ã  votre recherche</p>' +
                    '</div>';
                }
                
                return '<div class="empty-state">' +
                    '<div class="empty-state-icon">' +
                        '<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">' +
                            '<path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>' +
                        '</svg>' +
                    '</div>' +
                    '<h3 class="empty-state-title">Aucune conversation</h3>' +
                    '<p class="empty-state-text">Commencez Ã  discuter en visitant l\'onglet Utilisateurs</p>' +
                '</div>';
            },
            
            // Rendre la liste des conversations
            renderConversationsList: function() {
                var html = '<div class="conversation-list">';
                
                for (var i = 0; i < this.filteredConversations.length; i++) {
                    html += this.renderConversationItem(this.filteredConversations[i]);
                }
                
                html += '</div>';
                return html;
            },
            
            // Rendre un Ã©lÃ©ment de conversation
            renderConversationItem: function(conversation) {
                var otherUser = conversation.otherUser;
                var isLastMessageMine = conversation.lastMessageSenderId === this.currentUser.uid;
                var timeString = this.formatTime(conversation.lastMessageTimestamp);
                
                // Limiter la longueur du message
                var truncateMessage = function(message, type) {
                    if (!message) return 'Aucun message';
                    if (type === 'image') return 'ð· Image';
                    if (type === 'audio') return 'ð¤ Message vocal';
                    return message.length > 30 ? message.substring(0, 30) + '...' : message;
                };
                
                return '<div class="conversation-item" onclick="app.startChat(' + JSON.stringify(otherUser).replace(/"/g, '&quot;') + ')">' +
                    '<div class="conversation-avatar">' +
                        (otherUser.avatar 
                            ? '<img src="' + otherUser.avatar + '" alt="' + otherUser.username + '">'
                            : this.getInitials(otherUser.username)
                        ) +
                        '<div class="conversation-status ' + (otherUser.online ? 'online' : '') + '"></div>' +
                    '</div>' +
                    '<div class="conversation-content">' +
                        '<div class="conversation-name">' +
                            otherUser.username +
                            (otherUser.isBlocked ? '<span class="conversation-blocked" style="margin-left: 6px; font-size: 12px; font-weight: normal; color: #EF4444;">BloquÃ©</span>' : '') +
                        '</div>' +
                        '<div class="conversation-message">' +
                            (isLastMessageMine ? 'Vous: ' : '') + truncateMessage(conversation.lastMessage, conversation.lastMessageType) +
                        '</div>' +
                        (!otherUser.online && otherUser.lastSeen ? '<div style="font-size: 12px; color: #777; margin-top: 4px;">Vu ' + this.formatLastSeen(otherUser.lastSeen) + '</div>' : '') +
                    '</div>' +
                    '<div class="conversation-meta">' +
                        '<div class="conversation-time">' + timeString + '</div>' +
                        (conversation.unreadCount > 0 ? '<div class="conversation-badge">' + conversation.unreadCount + '</div>' : '') +
                    '</div>' +
                '</div>';
            },
            
            // Rendre l'onglet Utilisateurs
            renderUsersTab: function() {
                var searchHtml = '<div style="padding: 8px 16px;">' +
                    '<div style="display: flex; align-items: center; background-color: #f5f5f5; border-radius: 10px; padding: 8px 12px;">' +
                        '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#777" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">' +
                            '<circle cx="11" cy="11" r="8"></circle>' +
                            '<line x1="21" y1="21" x2="16.65" y2="16.65"></line>' +
                        '</svg>' +
                        '<input type="text" class="form-input" placeholder="Rechercher par nom ou tÃ©lÃ©phone..." value="' + this.searchQuery + '" oninput="app.handleSearch(this.value)" style="border: none; background: none; width: 100%; font-size: 16px;">' +
                        (this.searchQuery ? '<button onclick="app.clearSearch()" style="background: none; border: none; color: #777; padding: 4px;"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>' : '') +
                    '</div>' +
                '</div>';
                
                return '<div class="header">' +
                    '<h1 class="header-title">Utilisateurs</h1>' +
                '</div>' + 
                searchHtml +
                '<div class="main">' +
                    (this.filteredUsers.length === 0 ? this.renderEmptyUsers() : this.renderUsersList()) +
                '</div>';
            },
            
            // Rendre l'Ã©tat vide des utilisateurs
            renderEmptyUsers: function() {
                if (this.searchQuery) {
                    return '<div class="empty-state">' +
                        '<div class="empty-state-icon">' +
                            '<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">' +
                                '<circle cx="11" cy="11" r="8"></circle>' +
                                '<line x1="21" y1="21" x2="16.65" y2="16.65"></line>' +
                            '</svg>' +
                        '</div>' +
                        '<h3 class="empty-state-title">Aucun rÃ©sultat</h3>' +
                        '<p class="empty-state-text">Aucun utilisateur ne correspond Ã  votre recherche</p>' +
                    '</div>';
                }
                
                return '<div class="empty-state">' +
                    '<div class="empty-state-icon">' +
                        '<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">' +
                            '<path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>' +
                            '<circle cx="9" cy="7" r="4"></circle>' +
                            '<path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>' +
                            '<path d="M16 3.13a4 4 0 0 1 0 7.75"></path>' +
                        '</svg>' +
                    '</div>' +
                    '<h3 class="empty-state-title">Aucun utilisateur</h3>' +
                    '<p class="empty-state-text">Aucun utilisateur n\'est disponible actuellement</p>' +
                '</div>';
            },
            
            // Rendre la liste des utilisateurs
            renderUsersList: function() {
                var html = '<div class="user-list">';
                
                for (var i = 0; i < this.filteredUsers.length; i++) {
                    html += this.renderUserItem(this.filteredUsers[i]);
                }
                
                html += '</div>';
                return html;
            },
            
            // Rendre un Ã©lÃ©ment utilisateur
            renderUserItem: function(user) {
                return '<div class="user-item" onclick="app.startChat(' + JSON.stringify(user).replace(/"/g, '&quot;') + ')">' +
                    '<div class="user-avatar">' +
                        (user.avatar 
                            ? '<img src="' + user.avatar + '" alt="' + user.username + '">'
                            : this.getInitials(user.username)
                        ) +
                        '<div class="conversation-status ' + (user.online ? 'online' : '') + '"></div>' +
                    '</div>' +
                    '<div class="user-info">' +
                        '<div class="user-name">' +
                            user.username +
                            (user.isBlocked ? '<span style="margin-left: 6px; font-size: 12px; font-weight: normal; color: #EF4444;">BloquÃ©</span>' : '') +
                        '</div>' +
                        '<div class="user-status">' +
                            '<div class="status-dot ' + (user.online ? 'online' : '') + '"></div>' +
                            (user.online 
                                ? 'En ligne' 
                                : (user.lastSeen ? 'Vu ' + this.formatLastSeen(user.lastSeen) : 'Hors ligne')
                            ) +
                        '</div>' +
                        (user.bio ? '<div style="font-size: 14px; color: #777; margin-top: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">' + user.bio + '</div>' : '') +
                    '</div>' +
                '</div>';
            },
            
            // Rendre l'onglet Profil
            renderProfileTab: function() {
                if (!this.currentUser) {
                    return '<div class="loading"><div class="spinner"></div></div>';
                }
                
                return '<div class="header">' +
                    '<h1 class="header-title">Profil</h1>' +
                '</div>' +
                '<div class="main">' +
                    '<div class="profile-container">' +
                        '<div class="profile-header">' +
                            '<h1 style="font-size: 24px; margin-bottom: 8px;">Mon Profil</h1>' +
                            '<p>GÃ©rez vos informations et prÃ©fÃ©rences</p>' +
                            '<div class="profile-avatar-container" onclick="document.getElementById(\'avatar-upload\').click()">' +
                                '<input type="file" id="avatar-upload" class="input-file" accept="image/*" style="display: none;">' +
                                '<div class="profile-avatar">' +
                                    (this.currentUser.avatar 
                                        ? '<img src="' + this.currentUser.avatar + '" alt="' + this.currentUser.username + '">'
                                        : this.getInitials(this.currentUser.username)
                                    ) +
                                    '<div class="profile-avatar-edit">Modifier</div>' +
                                '</div>' +
                            '</div>' +
                        '</div>' +
                        '<div style="text-align: center; margin-bottom: 24px;">' +
                            '<h2 style="font-size: 18px; font-weight: 600; margin-bottom: 4px;">' + this.currentUser.username + '</h2>' +
                            '<p style="color: #777;">' + this.currentUser.email + '</p>' +
                        '</div>' +
                        '<div class="profile-card">' +
                            '<div class="profile-card-title">' +
                                '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">' +
                                    '<path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>' +
                                    '<circle cx="12" cy="7" r="4"></circle>' +
                                '</svg>' +
                                'Informations personnelles' +
                            '</div>' +
                            '<div class="profile-field">' +
                                '<div class="profile-field-label">Nom</div>' +
                                '<div class="profile-field-value">' + this.currentUser.username + '</div>' +
                            '</div>' +
                            '<div class="profile-field">' +
                                '<div class="profile-field-label">Email</div>' +
                                '<div class="profile-field-value">' + this.currentUser.email + '</div>' +
                            '</div>' +
                            '<div class="profile-field">' +
                                '<div class="profile-field-label">TÃ©lÃ©phone</div>' +
                                '<div class="profile-field-value">' + (this.currentUser.phone || 'Non renseignÃ©') + '</div>' +
                            '</div>' +
                            '<div class="profile-field">' +
                                '<div class="profile-field-label">Bio</div>' +
                                '<div class="profile-field-value">' + (this.currentUser.bio || 'Aucune bio') + '</div>' +
                            '</div>' +
                        '</div>' +
                        '<div class="profile-card">' +
                            '<div class="profile-card-title">' +
                                '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">' +
                                    '<path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 16V12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 8H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>' +
                                '</svg>' +
                                'Ã propos' +
                            '</div>' +
                            '<div style="padding: 12px 0;">' +
                                '<div style="font-weight: 500; margin-bottom: 6px;">ChatXchange for iOS</div>' +
                                '<div style="font-size: 14px; color: #777;">Version 1.0.0</div>' +
                            '</div>' +
                        '</div>' +
                        '<div class="profile-actions">' +
                            '<button class="action-button logout-button" onclick="app.handleLogout()">' +
                                '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">' +
                                    '<path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>' +
                                    '<polyline points="16 17 21 12 16 7"></polyline>' +
                                    '<line x1="21" y1="12" x2="9" y2="12"></line>' +
                                '</svg>' +
                                'Se dÃ©connecter' +
                            '</button>' +
                        '</div>' +
                    '</div>' +
                '</div>';
            },
            
            // Rendre l'Ã©cran de chat
            renderChatScreen: function() {
                if (!this.currentChat) {
                    return '<div class="container">' +
                        '<div class="header">' +
                            '<button class="back-button" onclick="app.currentScreen = \'main\'; app.render();">' +
                                '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">' +
                                    '<line x1="19" y1="12" x2="5" y2="12"></line>' +
                                    '<polyline points="12 19 5 12 12 5"></polyline>' +
                                '</svg>' +
                            '</button>' +
                            '<h1 class="header-title">Chat</h1>' +
                        '</div>' +
                        '<div class="main" style="display: flex; align-items: center; justify-content: center;">' +
                            '<p>Aucune conversation sÃ©lectionnÃ©e</p>' +
                        '</div>' +
                    '</div>';
                }
                
                return '<div class="chat-container">' +
                    '<div class="chat-header">' +
                        '<button class="back-button" onclick="app.currentScreen = \'main\'; app.render();">' +
                            '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">' +
                                '<line x1="19" y1="12" x2="5" y2="12"></line>' +
                                '<polyline points="12 19 5 12 12 5"></polyline>' +
                            '</svg>' +
                        '</button>' +
                        '<div class="chat-title">' +
                            this.currentChat.otherUser.username +
                            '<span class="chat-title-status">' +
                                (this.currentChat.otherUser.online 
                                    ? 'En ligne' 
                                    : 'Hors ligne'
                                ) +
                            '</span>' +
                        '</div>' +
                        '<button class="chat-menu-button" onclick="app.toggleBlockUser(\'' + this.currentChat.otherUser.uid + '\', ' + !this.currentChat.otherUser.isBlocked + ')">' +
                            '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">' +
                                '<circle cx="12" cy="12" r="10"></circle>' +
                                (this.currentChat.otherUser.isBlocked ? '<path d="M15 9L9 15M9 9L15 15"></path>' : '<path d="M15 9L9 15"></path>') +
                            '</svg>' +
                        '</button>' +
                    '</div>' +
                    '<div id="chat-messages" class="chat-messages">' +
                        this.renderChatMessages() +
                    '</div>' +
                    '<div class="chat-input-container">' +
                        '<div class="chat-input">' +
                            '<button class="media-button" disabled>' +
                                '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">' +
                                    '<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>' +
                                    '<circle cx="8.5" cy="8.5" r="1.5"></circle>' +
                                    '<polyline points="21 15 16 10 5 21"></polyline>' +
                                '</svg>' +
                            '</button>' +
                            '<div class="message-input-container">' +
                                '<input type="text" id="message-input" class="message-input" placeholder="Ãcrire un message..." onkeypress="if(event.key === \'Enter\') app.sendMessage()">' +
                            '</div>' +
                            '<button class="send-button" onclick="app.sendMessage()">' +
                                '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">' +
                                    '<line x1="22" y1="2" x2="11" y2="13"></line>' +
                                    '<polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>' +
                                '</svg>' +
                            '</button>' +
                        '</div>' +
                    '</div>' +
                '</div>';
            },
            
            // Rendre les messages du chat
            renderChatMessages: function() {
                if (this.messages.length === 0) {
                    return '<div class="empty-state">' +
                        '<div class="empty-state-icon">' +
                            '<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">' +
                                '<path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>' +
                            '</svg>' +
                        '</div>' +
                        '<h3 class="empty-state-title">Aucun message</h3>' +
                        '<p class="empty-state-text">DÃ©marrez la conversation !</p>' +
                    '</div>';
                }
                
                // Regrouper les messages par date
                var messagesByDate = {};
                var currentSender = null;
                var messageGroups = [];
                
                for (var i = 0; i < this.messages.length; i++) {
                    var message = this.messages[i];
                    var messageDate = new Date(message.timestamp).toDateString();
                    
                    if (!messagesByDate[messageDate]) {
                        messagesByDate[messageDate] = [];
                    }
                    
                    // Si l'expÃ©diteur change ou s'il y a plus de 5 minutes entre les messages, crÃ©er un nouveau groupe
                    var shouldCreateNewGroup = 
                        currentSender !== message.senderId || 
                        (messageGroups.length > 0 && 
                        messageGroups[messageGroups.length - 1].messages.length > 0 &&
                        message.timestamp - messageGroups[messageGroups.length - 1].messages[messageGroups[messageGroups.length - 1].messages.length - 1].timestamp > 5 * 60 * 1000);
                    
                    if (shouldCreateNewGroup) {
                        messageGroups.push({
                            senderId: message.senderId,
                            messages: [message],
                            date: messageDate
                        });
                        currentSender = message.senderId;
                    } else {
                        // Ajouter au dernier groupe
                        messageGroups[messageGroups.length - 1].messages.push(message);
                    }
                    
                    messagesByDate[messageDate].push(message);
                }
                
                // Rendre les messages par groupe
                var html = '';
                var lastDate = null;
                
                for (var j = 0; j < messageGroups.length; j++) {
                    var group = messageGroups[j];
                    
                    // Ajouter un sÃ©parateur de date si la date change
                    if (group.date !== lastDate) {
                        html += '<div class="message-day-separator">' +
                            '<span class="message-day-text">' + this.formatFullDate(new Date(group.date)) + '</span>' +
                        '</div>';
                        lastDate = group.date;
                    }
                    
                    var isSent = group.senderId === this.currentUser.uid;
                    var groupClass = isSent ? 'sent' : 'received';
                    
                    html += '<div class="message-group ' + groupClass + '">';
                    
                    for (var k = 0; k < group.messages.length; k++) {
                        var message = group.messages[k];
                        var messageClass = isSent ? 'message-sent' : 'message-received';
                        
                        // Formater l'heure
                        var time = new Date(message.timestamp).toLocaleTimeString([], { 
                            hour: '2-digit', 
                            minute: '2-digit'
                        });
                        
                        html += '<div class="message-bubble ' + messageClass + '">';
                        
                        // Rendre l'image si prÃ©sente
                        if (message.messageType === 'image' && message.image) {
                            html += '<div class="message-image-container">' +
                                '<img src="' + message.image + '" class="message-image" alt="Image envoyÃ©e">' +
                            '</div>';
                        }
                        
                        // Rendre le texte si prÃ©sent
                        if (message.text) {
                            html += '<div>' + message.text + '</div>';
                        }
                        
                        // Rendre l'heure et le statut de lecture
                        html += '<div class="message-time">' +
                            time +
                            (message.edited ? ' (modifiÃ©)' : '') +
                            (isSent ? '<span class="message-status">' +
                                (message.read ? '<svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 12l3 3 7-7" /></svg>' : 
                                '<svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 12l3 3 7-7" /></svg>') +
                            '</span>' : '') +
                        '</div>' +
                        '</div>';
                    }
                    
                    html += '</div>';
                }
                
                return html;
            },
            
            // Rendre l'application
            render: function() {
                var appElement = document.getElementById('app');
                
                if (!appElement) return;
                
                var content = '';
                
                switch (this.currentScreen) {
                    case 'loading':
                        this.renderLoadingScreen();
                        return;
                    case 'auth':
                        content = this.renderAuthScreen();
                        break;
                    case 'main':
                        content = this.renderMainScreen();
                        break;
                    case 'chat':
                        content = this.renderChatScreen();
                        break;
                    default:
                        content = '<div>Screen not found</div>';
                }
                
                appElement.innerHTML = content;
                
                // Faire dÃ©filer vers le bas aprÃ¨s le rendu de l'Ã©cran de chat
                if (this.currentScreen === 'chat') {
                    this.scrollToBottom();
                }
            }
        };
        
        // Initialiser l'application
        app.init();
    </script>
</body>
</html>
